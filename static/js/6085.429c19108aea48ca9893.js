/*! For license information please see 6085.429c19108aea48ca9893.js.LICENSE.txt */
(self.webpackChunkmathalea=self.webpackChunkmathalea||[]).push([[6085],{66085:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>ci});const s="http://www.w3.org/2000/svg",n={alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",pi:"π",rho:"ρ",sigma:"σ",tau:"τ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",Gamma:"Γ",Delta:"Δ",Xi:"Ξ",Pi:"Π",Sigma:"Σ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω"},r=Math.PI/180,o=180/Math.PI,a=Math.cos(30*r),c=.5;const h=function(t,e,i,s,n,r){this.bold=t,this.italic=e,this.underline=i,this.couleur=s,this.fontface=n,this.taille=r},l={};Object.entries({alpha2:"α",plus:"+",moins:"-",fois:"×",divise:"÷",petitf:"f",petitebarre:"–",grandebarre:"—",prime:"'",seconde:'"',puceronde:"•",grandC:"ℂ",euler:"ℂ",petitg:"ℊ",petith:"ℏ",Ironde:"ℑ",Lronde:"ℒ",lronde:"ℓ",grandN:"ℕ",Pronde:"℘",grandQ:"ℚ",Rronde:"ℜ",grandR:"ℝ",grandZ:"ℤ",Eronde:"ℰ",Fronde:"ℱ",Nronde:"ℵ",flecheG:"←",flecheH:"↑",flecheD:"→",flecheB:"↓",flecheDG:"↔",flecheGD:"↔",flecheHB:"↕",flecheBH:"↕",croissant:"↗",decroissant:"↘",alaligneadroite:"↳",alaligneagauche:"↵",doubleflecheG:"⇐",doubleflecheD:"⇒",doubleflecheDG:"⇔",doubleflecheGD:"⇔",flecheGbarre:"⇤",flecheDbarre:"⇥",flecheGcreuse:"⇦",flecheHcreuse:"⇧",flecheDcreuse:"⇨",flecheBcreuse:"⇩",qqsoit:"∀",pourtout:"∀",quelquesoit:"∀",complement:"∁",differentielpartiel:"∂",ilexiste:"∃",ilnexistepas:"∄",vide:"∅",nabla:"∇",appartienta:"∈",nappartientpasa:"∉",contient:"∋",petitcontient:"∍",grandproduit:"∏",grandcoproduit:"∐",grandesomme:"∑",petitebarrefine:"−",moinsouplus:"∓",antislash:"\\",asterisque:"∗",racine:"√",proportionnela:"∝",infini:"∞",angle:"∡",anglespherique:"∢",nedivisepas:"∤",parallelea:"//",nestpasparallelea:"∦",etlogique:"∧",oulogique:"∨",inter:"∩",intersection:"∩",union:"∪",integrale:"∫",doubleintegrale:"∬",tripleintegrale:"∭",integralecurviligne:"∮",integralesurfacique:"∯",integralevolumique:"∰",egaleasymptotiquea:"≃",environdroit:"≃",environegala:"≅",environ:"≈",egalpardefinition:"≝",differentde:"≠",identiquea:"≡",inferieura:"≤",superieura:"≥",inclusdans:"⊂",nestpasinclusdans:"⊄",necontientpas:"⊅",sommedirecte:"⊕",differencedirecte:"⊖",produittensoriel:"⊗",divisiondirecte:"⊘",produitdirect:"⊙",top:"⊤",perpendiculairea:"⊥",antecedentde:"⊶",imagede:"⊷",angledroitarc:"⊾",point:"⋅",pv:";"}).forEach((([t,e])=>{l[t.toLowerCase()]=e}));const u=t=>Math.abs(t)<1e-9;function d(t){let e=t-360*Math.floor((t+180)/360);return-180===e&&(e=180),e}const p=t=>["compas","compasLeve","crayon","equerre","rapporteur","regle","requerre"].includes(t);function b(t){let e,i,s,n=!1;if(0===t.indexOf("<font"))i="</font>",n=!0;else{if(s=t.indexOf(">"),-1===s)return t.length;e=t.substring(0,s+1),i=e.substring(0,1)+"/"+e.substring(1)}const r=t.indexOf(i);if(-1===r){if(n){const e=t.indexOf("<font",5);if(-1!==e)return e}return-1}return r+i.length}function g(t){const e=t.trim(),i={},s=e.indexOf(","),n=e.indexOf(")");return i.erreur=-1===s||-1===n,i.erreur?(i.texte="",i):(i.operande=e.substring(3,s),i.exposant=e.substring(s+1,n),i.texte=e.substring(n+1),i)}function f(t,e){let i,s,n=1;for(i=e+1;i<t.length&&(s=t.charAt(i),"("===s?n++:")"===s&&n--,0!==n);)i++;return 0===n?i:-1}function m(t,e,i,s,n){const r=(s-n)/(e-i);return r*t+(s-r*e)}function y(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<B>/g,"<b>")).replace(/<\/B>/g,"</b>")).replace(/<I>/g,"<i>")).replace(/<\/I>/g,"</i>")).replace(/<U>/g,"<u>")).replace(/<\/U>/g,"</u>")).replace(/£lt£i£gt£/gi,"<i>")).replace(/£i£/gi,"<i>")).replace(/£lt£\/i£gt£/gi,"</i>")).replace(/£\/i£/gi,"</i>")).replace(/£lt£b£gt£/gi,"<b>")).replace(/£b£/gi,"<b>")).replace(/£lt£\/b£gt£/gi,"</b>")).replace(/£\/b£/gi,"</b>")).replace(/£lt£u£gt£/gi,"<u>")).replace(/£u£/gi,"<u>")).replace(/£lt£\/u£gt£/gi,"</u>")).replace(/£\/u£/gi,"</u>")).replace(/£lt£br£gt£/gi,"<br>")).replace(/£lt£br\/£gt£/gi,"<br>")).replace(/£br£/gi,"<br>")).replace(/£br\/£/gi,"<br>")).replace(/£lt£font/gi,"<font")).replace(/£lt£\/font£gt£/gi,"</font>")).replace(/£lt£bold£gt£/gi,"<b>")).replace(/£lt£\/bold£gt£/gi,"</b>")).replace(/£lt£/gi,"<")).replace(/£gt£/gi,">")).replace(/£inferieurstrict£/gi,"<")).replace(/£superieurstrict£/gi,">")).replace(/£guillemet£/gi,'"')}function A(t){if(!t.includes("£"))return t;const e=t.split("£").map(((t,e)=>{if(e%2){const e=t.toLowerCase();return l[e]||`£${t}£`}return t})).join("");return(t.length-t.replace(/£/g,"").length)%2?(console.warn(`Il y a un nombre impair de £ dans cette chaîne : ${t}`),e.substr(0,e.length-1)):e}function x(t,e){let i,s,n;for(n=1,i=e+1;i<t.length&&(s=t.charAt(i),"{"===s?n++:"}"===s&&n--,0!==n);)i++;return 0===n?i:-1}function v(t){return-1!==t.indexOf("\\frac")||-1!==t.indexOf("\\sqrt")||-1!==t.indexOf("}^{")||-1!==t.indexOf("}_{")||-1!==t.indexOf("\\widehat{")||-1!==t.indexOf("\\left[")||-1!==t.indexOf("\\left(")||-1!==t.indexOf("\\left|")||-1!==t.indexOf("\\left\\|")||-1!==t.indexOf("\\overrightarrow{")||-1!==t.indexOf("\\text{")}function S(t){const e={noir:"black",rouge:"red",vert:"green",bleu:"blue",blanc:"white",gris:"grey",darkorange:"maroon"};if("0"===t)return"black";if(e[t])return e[t];const i=t=>t.length<7?"#"+"0".repeat(6-t.length)+t:t.substr(-6);return/^#/.test(t)?7===t.length?t:4===t.length?`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`:(console.error(Error(`couleur ${t} invalide, on va tronquer ou compléter avec des 0`)),i(t.substring(1))):/^0x/.test(t)?i(t.substring(2)):/^[0-9]/.test(t)?i(parseFloat(t).toString(16)):t}const w=(t,e)=>function(t,e){const i=t.norme(),s=e.norme();return!(!u(i)&&!u(s))||u((t.x*e.y-t.y*e.x)/i/s)}(t,e)&&t.x*e.x+t.y*e.y>=0;function E(t,e,i){let s,n,r=0,o=e;for(;o<t.length;){if(s=t.charAt(o),"("===s){if(n=f(t,o),-1===n)return-1;o=n}else if(","===s&&r++,r===i)return o;o++}return-1}function C(t,e,i){let s;return e*t<0?s=-Math.floor(-t/i)*i:Math.ceil(Math.log(Math.abs(t))/Math.LN10)!==Math.ceil(Math.log(Math.abs(e))/Math.LN10)?(s=t<0?-Math.pow(10,Math.floor(Math.log(Math.abs(t))/Math.LN10)):Math.pow(10,Math.ceil(Math.log(Math.abs(t))/Math.LN10)),s-=Math.floor((s-t)/i)*i):(s=function(t,e){const i=Math.pow(10,e);return Math.round(t/i)*i}(t,Math.floor(Math.log(i)/Math.LN10)),s<t&&(s+=i)),s}function N(t,e,i,n,r){if(""===t)return;let o,a,c,l,u,d,p,g,f;const m=t.search(/<b>|<i>|<u>|<font/),y=document.createElementNS(s,"tspan");if(y.setAttribute("pointer-events","none"),-1===m||m>0){o="",e.couleur&&(o+="fill:"+e.couleur+";"),e.bold&&(o+="font-weight:bold;"),e.italic&&(o+="font-style:italic;"),e.underline&&(o+="text-decoration:underline;"),""!==e.fontface?o+="font-family:"+e.fontface+";":o+='font-family: "Times New Roman", Times, serif;',o+="font-size:"+e.taille+"px;",y.setAttribute("style",o),n&&(y.setAttribute("x",0),n=!1),y.setAttribute("y",r);const s=-1===m?t:t.substring(0,m);y.appendChild(document.createTextNode(s)),i.appendChild(y),m>0&&N(t.substring(m),e,i,n,r)}else 0===t.indexOf("<b>")?(f=new h(!0,e.italic,e.underline,e.couleur,e.fontface),a=b(t),N(-1===a?t.substring(3):t.substring(3,a-4),f,i,n,r)):0===t.indexOf("<i>")?(f=new h(e.bold,!0,e.underline,e.couleur,e.fontface),a=b(t),N(-1===a?t.substring(3):t.substring(3,a-4),f,i,n,r)):0===t.indexOf("<u>")?(f=new h(e.bold,e.italic,!0,e.couleur,e.fontface),a=b(t),N(-1===a?t.substring(3):t.substring(3,a-4),f,i,n,r)):0===t.indexOf("<font")&&(a=b(t),-1===a&&(a=t.length),c=t.indexOf('face="'),-1!==c?(l=t.indexOf('"',c+6),u=-1!==l?t.substring(c+6,l):""):u="",d="",c=t.indexOf('couleur="'),-1!==c?(l=t.indexOf('"',c+9),-1!==l&&(d=S(t.substring(c+9,l)))):(c=t.indexOf('color="'),-1!==c&&(l=t.indexOf('"',c+7),-1!==l&&(d=S(t.substring(c+7,l))))),c=t.indexOf('size="'),-1!==c&&(l=t.indexOf('"',c+6),p=-1!==l?t.substring(c+6,l):e.taille),f=new h(e.bold,e.italic,e.underline,d,u,p),g=t.indexOf(">"),/<\/font>/i.test(t)?N(t.substring(g+1,a-7),f,i,n,r):N(t.substring(g+1),f,i,n,r))}function k(t){if(["a","c","d","f","g","n","p","r","s","u","v"].some((e=>t.includes(`£${e}(`))))return!0;let e,i,s,n=t;for(;-1!==(e=n.search(/£e\(|£i\(/g));){if(i=f(n,e+3),-1===i&&(i=n.length),s=n.substring(e,i),-1!==s.search(/£e\(|£i\(£lt£font/g))return!0;if(i===n.length)return!1;n=s.substring(i+1)}for(n=t;-1!==(e=n.search(/£lt£font/g));){if(i=b(n.substring(e)),-1===i?i=n.length:i+=e,s=n.substring(e,i),-1!==s.search(/£e\(|£i\(/g))return!0;if(i===n.length)return!1;n=s.substring(i+1)}return!1}function M(t,e){let i,s,n,r,o,a,c,h,l,u,d,p,g;const m=t;if(""===m)return"";for(;-1!==(i=m.indexOf("<font"));)return h=null,c=m.substring(i),s=b(c),r=c.indexOf('couleur="'),-1!==r?(o=c.indexOf('"',r+9),-1!==o&&(h=S(c.substring(r+9,o)))):(r=c.indexOf('color="'),-1!==r&&(o=c.indexOf('"',r+7),-1!==o&&(h=S(c.substring(r+7,o))))),null!=h?(a=i+c.indexOf(">")+1,-1===s?M(m.substring(0,i)+"\\textcolor{"+h+"}{"+m.substring(a)+"}",e):(s+=i,M(m.substring(0,i)+"\\textcolor{"+h+"}{"+m.substring(a,s-7)+"}"+m.substring(s),e))):(a=i+c.indexOf(">")+1,-1===s?M(m.substring(0,i)+m.substring(a),e):(s+=i,M(m.substring(0,i)+m.substring(a,s-7)+m.substring(s),e)));for(;-1!==(i=m.indexOf("£u("));)return s=f(m,i+2),-1===s?m:M(m.substring(0,i),e)+"\\unicode{x"+m.substring(i+3,s)+"}"+M(m.substring(s+1),e);for(;-1!==(i=m.indexOf("£f("));)return n=E(m,i+3,1),s=f(m,i+2),-1===n||-1===s||n>s?m:M(M(m.substring(0,i),e)+"\\displaystyle{\\frac{"+M(m.substring(i+3,n),!1)+"}{"+M(m.substring(n+1,s),!1)+"}}"+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("£r("));)return s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\sqrt{"+M(m.substring(i+3,s),!1)+"}"+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("£a("));)return s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\widehat{"+M(m.substring(i+3,s),!0)+"}"+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("£g("));)return u=E(m,i+3,1),d=E(m,i+3,2),p=E(m,i+3,3),s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\int_{"+M(m.substring(d+1,p),!1)+"}^{"+M(m.substring(p+1,s),!1)+"}"+M(m.substring(i+3,u),!1)+" d"+M(m.substring(u+1,d),!1)+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("£c("));)return s=f(m,i+2),-1===s?m:M(m.substring(0,i),e)+"\\left["+M(m.substring(i+3,s),e)+"\\right]"+M(m.substring(s+1),e);for(;-1!==(i=m.indexOf("£p("));)return s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\left("+M(m.substring(i+3,s),e)+"\\right)"+M(m.substring(s+1),e));for(;-1!==(i=m.indexOf("£d("));)return s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\left|"+M(m.substring(i+3,s),!1)+"\\right|"+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("£n("));)return s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\left\\|"+M(m.substring(i+3,s),!1)+"\\right\\|"+M(m.substring(s+1),e));for(;-1!==(i=m.indexOf("£i("));)return n=E(m,i+3,1),s=f(m,i+2),-1===n||-1===s||n>s?m:M(M(m.substring(0,i),e)+"{"+M(m.substring(i+3,n),!1)+"}_{"+M(m.substring(n+1,s),!1)+"}"+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("£e("));)return n=E(m,i+3,1),s=f(m,i+2),-1===n||-1===s||n>s?m:M(M(m.substring(0,i),e)+"{"+M(m.substring(i+3,n),!1)+"}^{"+M(m.substring(n+1,s),!1)+"}"+M(m.substring(s+1),e));for(;-1!==(i=m.indexOf("£v("));)return s=f(m,i+2),-1===s?m:M(M(m.substring(0,i),e)+"\\overrightarrow{"+M(m.substring(i+3,s),!1)+"}"+M(m.substring(s+1),e),e);for(;-1!==(i=m.indexOf("<u>"));)return s=b(m.substring(i)),-1===s?m:(s+=i,M(m.substring(0,i),e)+"\\underline{"+M(m.substring(i+3,s-4),!0)+"}"+M(m.substring(s),e));for(;-1!==(i=m.indexOf("<i>"));)return s=b(m.substring(i)),-1===s?M(m.substring(0,i),e)+"\\textit{"+M(m.substring(i+3),!1)+"}":(s+=i,M(m.substring(0,i),e)+"\\textit{"+M(m.substring(i+3,s-4),!1)+"}"+M(m.substring(s),e));for(;-1!==(i=m.indexOf("<b>"));)return s=b(m.substring(i)),-1===s?M(m.substring(0,i),e)+"\\textbf{"+M(m.substring(i+3),!1)+"}":(s+=i,M(m.substring(0,i),e)+"\\textbf{"+M(m.substring(i+3,s-4),!1)+"}"+M(m.substring(s),e));if(e){if(g=m.charAt(0),")"===g||","===g||"}"===g)return g+M(m.substring(1),e);if(v(m))return m;if(i=m.indexOf("\\textcolor{"),-1!==i){for(l="",c=m;-1!==(i=c.indexOf("\\textcolor{"));)r=c.indexOf("}{"),s=x(c,r+1),-1===s?0===i?(r+2!==c.length?l+=c.substring(0,r+2)+"\\text{"+c.substring(r+2)+"}":l+=c,c=""):(r+2!==c.length?l+="\\text{"+c.substring(0,i)+"}"+c.substring(i,r+2)+"\\text{"+c.substring(r+2)+"}":l+="\\text{"+c.substring(0,i)+"}"+c.substring(i,r+2),c=""):0===i?(l+=c.substring(0,s+1),c=s<c.length-1?c.substring(s+1):""):(l+="\\text{"+c.substring(0,i)+"}"+c.substring(i,r+2)+"\\text{"+c.substring(r+2,s+1)+"}",c=s<c.length-1?c.substring(s+1):"");return""===c?l:l+"\\text{"+c+"}"}{let t=0,e=0;for(;" "===m.charAt(e);)t++,e++;return"~".repeat(t)+"\\text{"+m.substring(e)+"}"}}return m}function P(t,e){let i,s,n,r,o,a,c,h,l,u,d=t;if(""===d)return"";for(;-1!==(i=d.indexOf("<font"));)return h=null,c=d.substring(i),s=b(c),r=c.indexOf('couleur="'),-1!==r?(o=c.indexOf('"',r+9),-1!==o&&(h=S(c.substring(r+9,o)))):(r=c.indexOf('color="'),-1!==r&&(o=c.indexOf('"',r+7),-1!==o&&(h=S(c.substring(r+7,o))))),null!==h?(a=i+c.indexOf(">")+1,-1===s?P(d.substring(0,i)+"\\textcolor{"+h+"}{"+d.substring(a)+"}",e):(s+=i,P(d.substring(0,i)+"\\textcolor{"+h+"}{"+d.substring(a,s-7)+"}"+d.substring(s),e))):(a=i+c.indexOf(">")+1,-1===s?P(d.substring(0,i)+d.substring(a),e):(s+=i,P(d.substring(0,i)+d.substring(a,s-7)+d.substring(s),e)));for(;-1!==(i=d.indexOf("£u("));)return s=f(d,i+2),-1===s?d:P(d.substring(0,i),e)+"\\unicode{x"+d.substring(i+3,s)+"}"+P(d.substring(s+1),e);for(;-1!==(i=d.indexOf("£r("));)return s=f(d,i+2),-1===s?d:P(P(d.substring(0,i),e)+"\\sqrt{"+P(d.substring(i+3,s),!1)+"}"+P(d.substring(s+1),e),e);for(;-1!==(i=d.indexOf("£d("));)return s=f(d,i+2),-1===s?d:P(P(d.substring(0,i),e)+"\\left|"+P(d.substring(i+3,s),!1)+"\\right|"+P(d.substring(s+1),e),e);for(;-1!==(i=d.indexOf("£n("));)return s=f(d,i+2),-1===s?d:P(P(d.substring(0,i),e)+"\\left\\|"+P(d.substring(i+3,s),!1)+"\\right\\|"+P(d.substring(s+1),e));for(;-1!==(i=d.indexOf("£i("));)return n=E(d,i+3,1),s=f(d,i+2),-1===n||-1===s||n>s?d:P(P(d.substring(0,i),e)+"{"+P(d.substring(i+3,n),!0)+"}_{"+P(d.substring(n+1,s),!1)+"}"+P(d.substring(s+1),e),e);for(;-1!==(i=d.indexOf("£e("));)return n=E(d,i+3,1),s=f(d,i+2),-1===n||-1===s||n>s?d:P(P(d.substring(0,i),e)+"{"+P(d.substring(i+3,n),!0)+"}^{"+P(d.substring(n+1,s),!1)+"}"+P(d.substring(s+1),e));for(;-1!==(i=d.indexOf("£v("));)return s=f(d,i+2),-1===s?d:P(P(d.substring(0,i),e)+"\\overrightarrow{"+P(d.substring(i+3,s),!1)+"}"+P(d.substring(s+1),e),e);for(;-1!==(i=d.indexOf("<u>"));)return s=b(d.substring(i)),-1===s?d:(s+=i,P(d.substring(0,i),e)+"\\underline{"+P(d.substring(i+3,s-4),!0)+"}"+P(d.substring(s),e));for(;-1!==(i=d.indexOf("<i>"));)return s=b(d.substring(i)),-1===s?P(d.substring(0,i),e)+"\\textit{"+P(d.substring(i+3),!1)+"}":(s+=i,P(d.substring(0,i),e)+"\\textit{"+P(d.substring(i+3,s-4),!1)+"}"+P(d.substring(s),e));for(;-1!==(i=d.indexOf("<b>"));)return s=b(d.substring(i)),-1===s?P(d.substring(0,i),e)+"\\textbf{"+P(d.substring(i+3),!1)+"}":(s+=i,P(d.substring(0,i),e)+"\\textbf{"+P(d.substring(i+3,s-4),!1)+"}"+P(d.substring(s),e));if(e){if(v(d))return d;if(i=d.indexOf("\\textcolor{"),-1!==i){for(l="",c=d;-1!==(i=c.indexOf("\\textcolor{"));)r=c.indexOf("}{"),s=x(c,r+1),-1===s?0===i?(r+2!==c.length?l+=c.substring(0,r+2)+"\\text{"+c.substring(r+2)+"}":l+=c,c=""):(r+2!==c.length?l+="\\text{"+c.substring(0,i)+"}"+c.substring(i,r+2)+"\\text{"+c.substring(r+2)+"}":l+="\\text{"+c.substring(0,i)+"}"+c.substring(i,r+2),c=""):0===i?(l+=c.substring(0,s+1),c=s<c.length-1?c.substring(s+1):""):(l+="\\text{"+c.substring(0,i)+"}"+c.substring(i,r+2)+"\\text{"+c.substring(r+2,s+1)+"}",c=s<c.length-1?c.substring(s+1):"");return""===c?l:l+"\\text{"+c+"}"}if(u=d.charAt(0),")"===u||","===u||"}"===u)return d;{let t="";for(;0===d.indexOf(" ");)t+="~",d=d.substring(1);return t+"\\text{"+d+"}"}}return d}function F(t,e={}){if(!t||"object"!=typeof t)throw Error("objet invalide");const i=e.defaut||20,s=e.min||5,n=e.max||199;if("number"!=typeof i||"number"!=typeof s||"number"!=typeof n)throw Error("options invalides");const r=Number(t.taille);return isNaN(r)?(console.error(Error(`taille invalide (${t.taille}) => ${i}`)),i):r<s?(console.error(Error(`taille trop petite (${t.taille} < ${s}) => ${i}`)),i):r>n?(console.error(Error(`taille trop grande (${t.taille} > ${n}) => ${i}`)),i):r}const I=O;function O(t,e,i,s){arguments.length>2?(this.x=i-t,this.y=s-e):(this.x=t,this.y=e)}O.prototype.presqueNul=function(){return u(this.x)&&u(this.y)},O.prototype.norme=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},O.prototype.vecteurColineaire=function(t){const e=this.norme();return new O(this.x/e*t,this.y/e*t)},O.prototype.tourne=function(t){const e=Math.cos(t*r),i=Math.sin(t*r);return new O(e*this.x-i*this.y,e*this.y+i*this.x)},O.prototype.angle=function(){let t;return 0===this.x&&0===this.y?0:(0===this.x?t=this.y>0?3*Math.PI/2:Math.PI/2:(t=this.x>=0?Math.atan(-this.y/this.x):Math.PI-Math.atan(this.y/this.x),t<0&&(t+=2*Math.PI)),t*o)};const j=L;function L(t){this.doc=t,this.x=200,this.y=400,this.angle=0,this.zoomfactor=1,this.visible=!1}L.prototype.montre=function(t){this.visible=t,this.g.setAttribute("visibility",t?"visible":"hidden")},L.prototype.updateg=function(){this.initialisePosition(),this.doc.svg.removeChild(this.g),this.doc.svg.appendChild(this.g)},L.prototype.translate=function(t,e){this.setPosition(t,e,this.angle,this.zoomfactor)},L.prototype.angleInit=function(){return 0},L.prototype.setPosition=function(t,e,i,s){let n;this.x=t,this.y=e,this.angle=i,arguments.length>=4?(n=s,this.zoomfactor=n):n=this.zoomfactor,this.g.setAttribute("transform","scale("+n+") translate("+String(t/n)+","+String(e/n)+") rotate("+i+")")},L.prototype.initialisePosition=function(){this.setPosition(200,400,this.angleInit(),1)},L.prototype.lanceAnimationTranslation=function(t,e,i){this.xfin=t,this.yfin=e,this.pix=Math.abs(i/2);const s=new I(this.x,this.y,t,e);if(this.dist=s.norme(),0===this.dist)return void this.doc.actionSuivante();this.vect=s.vecteurColineaire(this.pix);const n=this;this.timer=setInterval((function(){n.actionPourTranslation()}),25)},L.prototype.actionPourTranslation=function(){const t=this.x+this.vect.x,e=this.y+this.vect.y,i=new I(t,e,this.xfin,this.yfin).norme();i>this.dist||!this.doc.animationEnCours?(this.setPosition(this.xfin,this.yfin,this.angle),this===this.doc.compas&&null!=this.doc.compasLeve&&this.doc.compasLeve.visible&&this.doc.compasLeve.setPosition(this.xfin,this.yfin,this.angle),clearInterval(this.timer),this.doc.actionSuivante()):(this.dist=i,this.setPosition(t,e,this.angle),this===this.doc.compas&&null!=this.doc.compasLeve&&this.doc.compasLeve.visible&&this.doc.compasLeve.setPosition(t,e,this.angle))},L.prototype.lanceAnimationRotation=function(t,e){const i=d(this.angle);let s=d(t);Math.abs(s-i)>180&&(s>i?s-=360:s+=360),this.anglefin=s,this.angle=i,this.pasdeg=e/3,this.pasdeg*=s>=i?1:-1,this.distang=Math.abs(s-this.angle);const n=this;this.timer=setInterval((function(){n.actionPourRotation()}),25)},L.prototype.actionPourRotation=function(){const t=parseFloat(this.angle)+parseFloat(this.pasdeg),e=Math.abs(t-this.anglefin);e>this.distang||!this.doc.animationEnCours?(this.setPosition(this.x,this.y,this.anglefin),clearInterval(this.timer),this.doc.actionSuivante()):(this.distang=e,this.setPosition(this.x,this.y,t))},L.prototype.lanceAnimationZoom=function(t,e){this.zoomfin=t,this.vitesse=parseInt(e),this.pas=.05*this.vitesse*(this.zoomfin-this.zoomfactor),this.senspos=this.pas>=0;const i=this;this.timer=setInterval((function(){i.actionPourZoom()}),100)},L.prototype.actionPourZoom=function(){const t=this.zoomfactor+this.pas;this.doc.animationEnCours&&(this.senspos&&t<this.zoomfin||!this.senspos&&t>this.zoomfin)?this.setPosition(this.x,this.y,this.angle,t):(this.zoomfactor=this.zoomfin,this.positionne(),clearInterval(this.timer),this.doc.actionSuivante())},L.prototype.positionne=function(){this.setPosition(this.x,this.y,this.angle,this.zoomfactor)};const R=_;function _(t){j.call(this,t),this.ecart=0,this.bretourne=!1,this.leve=!1,this.lon=185,this.longpointe=18;const e=this.lon+this.longpointe;this.alp=Math.asin(this.ecart/(2*e))/Math.PI*180,this.decbh=30,this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(this.x,this.y,this.angle,1),t.svg.appendChild(this.g)}_.prototype=new j,_.prototype.initialisePosition=function(){j.prototype.initialisePosition.call(this),this.ecart=0,this.positionne()},_.prototype.creeg=function(){let t,e,i,n;const r=this.lon,o=this.longpointe,a=3.5,c=document.createElementNS(s,"g");this.bg=document.createElementNS(s,"g"),t=document.createElementNS(s,"line"),t.setAttribute("x1",0),t.setAttribute("y1",0),t.setAttribute("x2",0),t.setAttribute("y2",-o),t.setAttribute("style","stroke: black; stroke-width:1.5;"),this.bg.appendChild(t),e=document.createElementNS(s,"path"),i="M0 "+String(-o)+"L 0 "+String(-o-r)+" "+String(-7)+" "+String(-o-r)+" "+String(-7)+" "+String(-o)+"Z",e.setAttribute("d",i),e.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),this.bg.appendChild(e),n=document.createElementNS(s,"circle"),n.setAttribute("cx",-3.5),n.setAttribute("cy",-o-20),n.setAttribute("r",6),n.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),this.bg.appendChild(n),n=document.createElementNS(s,"circle"),n.setAttribute("cx",-3.5),n.setAttribute("cy",-o-20),n.setAttribute("r",2),n.setAttribute("style","stroke:black;stroke-width:1; fill: silver; fill-opacity: 1"),this.bg.appendChild(n),c.appendChild(this.bg),this.bd=document.createElementNS(s,"g"),e=document.createElementNS(s,"path"),i="M 0 0 L0 "+String(-o)+" "+"3.5 "+String(-o-a)+" "+"3.5 "+String(-6.5)+"Z",e.setAttribute("style","stroke:black;stroke-width:0.75; fill: blck; fill-opacity: 1"),e.setAttribute("d",i),this.bd.appendChild(e),e=document.createElementNS(s,"path"),i="M0 "+String(-o)+"L 0 "+String(-o-r)+" 7 "+String(-o-r)+" 7 "+String(-o)+"Z",e.setAttribute("d",i),e.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),this.bd.appendChild(e),e=document.createElementNS(s,"path");i="M7 "+String(-o-20+4.5)+"A 4.5 3 -90 0 0 7 "+String(-o-20-4.5)+"Z",e.setAttribute("style","stroke:black;stroke-width:1; fill: silver; fill-opacity: 1"),e.setAttribute("d",i),this.bd.appendChild(e);const h="stroke: black; stroke-width:1;";t=document.createElementNS(s,"line"),t.setAttribute("x1",0),t.setAttribute("y1",-100),t.setAttribute("x2",7),t.setAttribute("y2",-93),t.setAttribute("style",h),this.bd.appendChild(t),t=document.createElementNS(s,"line"),t.setAttribute("x1",0),t.setAttribute("y1",-50),t.setAttribute("x2",7),t.setAttribute("y2",-50),t.setAttribute("style",h),this.bd.appendChild(t),t=document.createElementNS(s,"line"),t.setAttribute("x1",3.5),t.setAttribute("y1",-50),t.setAttribute("x2",3.5),t.setAttribute("y2",-73),t.setAttribute("style",h),this.bd.appendChild(t);const l=document.createElementNS(s,"rect");l.setAttribute("x",7),l.setAttribute("y",-68),l.setAttribute("width",4),l.setAttribute("height",12),l.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),this.bd.appendChild(l),c.appendChild(this.bd),this.haut=document.createElementNS(s,"g"),e=document.createElementNS(s,"path"),i="M 0 0 L3 0 12 "+String(-24)+" "+"12 "+String(-35)+"A"+String(15)+" "+String(6)+" -90 0 1 6 "+String(-50)+"L3 "+String(-70)+" "+String(-3)+" "+String(-70)+"L"+String(-6)+" "+String(-50)+"A"+String(15)+" "+String(6)+" 90 0 1 "+String(-12)+" "+String(-35)+" L "+String(-12)+" "+String(-24)+" "+String(-3)+" 0Z",e.setAttribute("d",i),e.setAttribute("style","stroke:black;stroke-width:0.75; fill: #666666; fill-opacity: 1"),this.haut.appendChild(e),t=document.createElementNS(s,"line"),t.setAttribute("x1",6),t.setAttribute("y1",-50),t.setAttribute("x2",-6),t.setAttribute("y2",-50),t.setAttribute("style","stroke: black; stroke-width:1;"),this.haut.appendChild(t);const u=document.createElementNS(s,"text");u.setAttribute("pointer-events","none"),u.appendChild(document.createTextNode("Sésamath")),u.setAttribute("x",0),u.setAttribute("y",0),u.setAttribute("style","font-family: Arial;font-size: 5pt;fill: white"),u.setAttribute("transform","rotate(-90) translate(4,2.5)"),this.haut.appendChild(u),n=document.createElementNS(s,"circle"),n.setAttribute("cx",-6),n.setAttribute("cy",-this.decbh),n.setAttribute("r",3),n.setAttribute("style","stroke:black;stroke-width:1; fill: white; fill-opacity: 1"),this.haut.appendChild(n),n=document.createElementNS(s,"circle"),n.setAttribute("cx",6),n.setAttribute("cy",-this.decbh),n.setAttribute("r",3),n.setAttribute("style","stroke:black;stroke-width:1; fill: white; fill-opacity: 1"),this.haut.appendChild(n),c.appendChild(this.haut),this.g=c},_.prototype.setPosition=function(t,e,i,s){let n;arguments.length>=4?(n=s,this.zoomfactor=n):n=this.zoomfactor,this.x=t,this.y=e,this.angle=i;const r=this.lon+this.longpointe;let o=this.ecart/(2*r*n);if(o>1&&(o=1),this.alp=Math.asin(o)/Math.PI*180,isNaN(this.alp))console.error(Error("dans compas.setPosition on a alp qui est NaN")),this.doc.debug&&console.log(`avec x=${t}, y=${e}, angle=${i} et zoom=${n} on a d=${r} et ecart=${this.ecart} asin(${this.ecart}/${2*r*n}/π*180) donne NaN`);else{this.bg.setAttribute("transform",`rotate(${this.alp})`),this.bd.setAttribute("transform",`translate(${this.ecart/n}, 0) rotate(${-this.alp})`);const s=this.alp/180*Math.PI,o=this.ecart/2/n,a=-r*Math.cos(s)+this.decbh;this.haut.setAttribute("transform",`translate(${o},${a})`);const c=this.bretourne?`scale(${n},${-n})`:`scale(${n})`;this.g.setAttribute("transform",`${c} translate(${t/n},${e/n}) rotate(${i})`)}},_.prototype.retourne=function(){this.bretourne=!this.bretourne,this.setPosition(this.x,this.y,this.angle)},_.prototype.positionne=function(){j.prototype.positionne.call(this),this.leve&&null!=this.doc.compasLeve&&j.prototype.positionne.call(this.doc.compasLeve)},_.prototype.translate=function(t,e){j.prototype.translate.call(this,t,e),this.leve&&null!=this.doc.compasLeve&&j.prototype.translate.call(this.doc.compasLeve,t,e)},_.prototype.lanceAnimationEcartement=function(t,e){this.ecartfin=parseFloat(t),this.pasecart=e/4,this.pasecart*=t>=this.ecart?1:-1,this.distecart=Math.abs(t-this.ecart);const i=this;this.timer=setInterval((function(){i.actionPourEcartement()}),25)},_.prototype.actionPourEcartement=function(){const t=this.ecart+this.pasecart,e=Math.abs(t-this.ecartfin);e>this.distecart||!this.doc.animationEnCours?(this.ecart=this.ecartfin,this.setPosition(this.x,this.y,this.angle),clearInterval(this.timer),this.doc.actionSuivante()):(this.distecart=e,this.ecart=t,this.setPosition(this.x,this.y,this.angle))};const $=z;function z(t){j.call(this,t),this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(this.x,this.y,this.angle),t.svg.appendChild(this.g)}z.prototype=new j,z.prototype.creeg=function(){let t,e;const i=document.createElementNS(s,"g");t=document.createElementNS(s,"path"),e="M 0 0 L 131 0 L 0 "+String(-223)+" Z";const n="M 24 "+String(-31)+" L 24 "+String(-134.83969465648855)+" L "+String(85)+" "+String(-31)+" Z";e+=n,t.setAttribute("d",e),t.setAttribute("style","stroke:black;stroke-width:0.75; fill: #c6cbe8; fill-opacity: 0.5"),i.appendChild(t),t=document.createElementNS(s,"path"),e="M 16 "+String(-16)+" L 121.60089686098655 "+String(-16)+" L "+"16 "+"-195.76335877862596 Z",e+=n,t.setAttribute("d",e),t.setAttribute("style","stroke-width:0; fill: #c6cbe8; fill-opacity: 0.5"),i.appendChild(t);const r=document.createElementNS(s,"text");r.setAttribute("pointer-events","none"),r.appendChild(document.createTextNode("Sésamath")),r.setAttribute("x",24),r.setAttribute("y",-13),r.setAttribute("style","font-family: Arial;font-size: 8pt;font-weight:bold;fill: maroon"),i.appendChild(r),this.g=i};const B=V;function V(t){j.call(this,t),this.graduationExterneVisible=!0,this.graduationInterneVisible=!0,this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(this.x,this.y,this.angle),t.svg.appendChild(this.g)}V.prototype=new j,V.prototype.creeg=function(){let t,e,i,n,r;const o=156,a=String(o),c=String(89),h=document.createElementNS(s,"g");for(e=document.createElementNS(s,"path"),t="M "+a+" 0 A "+a+" "+a+" 0 0 0 -"+a+" 0 L -"+a+" "+"13 L "+a+" "+"13 L "+a+" 0",t+="M 0 0 L -"+c+" 0 A "+c+" "+c+" 0 0 1 "+c+" 0 Z",e.setAttribute("d",t),e.setAttribute("style","stroke:#999999;stroke-width:1; fill: #c6cbe8; fill-opacity: 0.5"),h.appendChild(e),e=document.createElementNS(s,"path"),t="M 7 0 A 7 7 0 0 0 -7 0 M 0 0 L 0 -7",e.setAttribute("d",t),e.setAttribute("style","stroke: #666666;stroke-width:1; fill: none"),h.appendChild(e),n=0;n<=180;n++)i=document.createElementNS(s,"line"),i.setAttribute("x1",a),i.setAttribute("y1",0),i.setAttribute("x2",n%10==0?136:n%5==0?146:151),i.setAttribute("y2",0),i.setAttribute("transform","rotate(-"+n+")"),i.setAttribute("style","stroke: #333333;stroke-width:0.7;"),h.appendChild(i);for(this.gradext=document.createElementNS(s,"g"),n=0;n<=180;n++)n%10==0&&(r=document.createElementNS(s,"text"),r.setAttribute("pointer-events","none"),r.appendChild(document.createTextNode(n)),r.setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("style","font-family: arial;font-size: 10px;text-anchor: middle; fill: black"),r.setAttribute("transform"," scale(-1) rotate("+String(-n-90)+") translate(0,"+String(-124)+")"),this.gradext.appendChild(r));h.appendChild(this.gradext);for(e=document.createElementNS(s,"path"),t="M "+String(120)+" 0 L "+"116 0 A "+"116 "+"116 0 0 0 -"+"116 0 L "+String(-120)+" 0",e.setAttribute("d",t),e.setAttribute("style","stroke: #666666;stroke-width:1; fill: none"),h.appendChild(e),n=0;n<=18;n++)i=document.createElementNS(s,"line"),i.setAttribute("x1",89),i.setAttribute("y1",0),i.setAttribute("x2",99),i.setAttribute("y2",0),i.setAttribute("transform","rotate(-"+String(10*n)+")"),i.setAttribute("style","stroke: #333333;stroke-width:0.7;"),h.appendChild(i);for(this.gradint=document.createElementNS(s,"g"),n=0;n<=18;n++)r=document.createElementNS(s,"text"),r.setAttribute("pointer-events","none"),r.appendChild(document.createTextNode(180-10*n)),r.setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("style","font-family: arial;font-size: 9px;text-anchor: middle; fill: black"),r.setAttribute("transform","scale(-1) rotate("+String(-10*n-90)+") translate(0,"+String(-103)+")"),this.gradint.appendChild(r);h.appendChild(this.gradint);const l=document.createElementNS(s,"circle");l.setAttribute("cx",0),l.setAttribute("cy",0),l.setAttribute("r",2),l.setAttribute("style","stroke: black; stroke-width: 1;fill: none"),h.appendChild(l),r=document.createElementNS(s,"text"),r.setAttribute("pointer-events","none"),r.appendChild(document.createTextNode("Sésamath")),r.setAttribute("x",0),r.setAttribute("y",11),r.setAttribute("style","font-family: sans-serif;font-size: 7pt;font-weight:bold;text-anchor: middle; fill: maroon"),h.appendChild(r),this.g=h},V.prototype.montreGraduations=function(t){this.graduationInterneVisible=!0,this.visible&&this.gradint.setAttribute("visibility",t?"visible":"hidden")},V.prototype.montreGraduationsExternes=function(t){this.graduationExterneVisible=!0,this.visible&&this.gradext.setAttribute("visibility",t?"visible":"hidden")},V.prototype.montre=function(t){j.prototype.montre.call(this,t),t?(this.gradint.setAttribute("visibility",this.graduationInterneVisible?"visible":"hidden"),this.gradext.setAttribute("visibility",this.graduationExterneVisible?"visible":"hidden")):(this.gradint.setAttribute("visibility","hidden"),this.gradext.setAttribute("visibility","hidden"))};const T=q;function q(t){j.call(this,t),this.x=100,this.y=400,this.angle=0,this.longueur=15,this.graduationVisible=!0,this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(this.x,this.y,this.angle),t.svg.appendChild(this.g)}q.prototype=new j,q.prototype.creeg=function(){let t,e;const i=30*this.longueur+15,n=String(57),r=String(6),o=document.createElementNS(s,"g"),a=document.createElementNS(s,"rect");a.setAttribute("x",-r-1),a.setAttribute("y",0),a.setAttribute("width",String(i+6+1)),a.setAttribute("height",n),a.setAttribute("rx",r),a.setAttribute("ry",r),a.setAttribute("style","stroke:#999999;stroke-width:2; fill: #c6cbe8; fill-opacity: 0.5;"),o.appendChild(a);const c=document.createElementNS(s,"line");c.setAttribute("x1",-r),c.setAttribute("y1",27),c.setAttribute("x2",i),c.setAttribute("y2",27),c.setAttribute("style","stroke:#999999;stroke-width:2;"),o.appendChild(c),this.graduations=document.createElementNS(s,"g");for(let h=0;h<=10*this.longueur;h++){t=document.createElementNS(s,"line");const i=3*h;t.setAttribute("x1",i),t.setAttribute("y1",0),t.setAttribute("x2",i),t.setAttribute("y2",h%10==0?12:h%5==0?9:6),h%10==0&&(e=document.createElementNS(s,"text"),e.setAttribute("pointer-events","none"),e.appendChild(document.createTextNode(String(h/10))),e.setAttribute("x",i),e.setAttribute("y",21),e.setAttribute("style","font-family: monospace;font-size: 9pt;text-anchor:middle"),this.graduations.appendChild(e)),t.setAttribute("style","stroke:black;stroke-width:0.7;"),this.graduations.appendChild(t)}e=document.createElementNS(s,"text"),e.setAttribute("pointer-events","none"),e.appendChild(document.createTextNode("Sésamath")),e.setAttribute("x",i/2-6-3),e.setAttribute("y",n-5),e.setAttribute("style","font-family: Arial;font-size: 8pt;font-weight:bold;fill: maroon;text-anchor:middle;"),o.appendChild(e),o.appendChild(this.graduations),this.g=o},q.prototype.montreGraduations=function(t){this.graduationVisible=t,this.graduations.setAttribute("visibility",this.visible&&t?"visible":"hidden")},q.prototype.montre=function(t){j.prototype.montre.call(this,t),t?this.graduations.setAttribute("visibility",this.graduationVisible?"visble":"hidden"):this.graduations.setAttribute("visibility","hidden")},q.prototype.initialisePosition=function(){if(15!==this.longueur){this.longueur=15;const t=this.visible,e=this.g;this.creeg(),this.g.setAttribute("visibility",t?"visible":"hidden"),this.doc.svg.replaceChild(this.g,e)}j.prototype.initialisePosition.call(this)};const G=D;function D(t){j.call(this,t),this.x=200,this.y=400,this.angle=0,this.zoomfactor=1,this.abscisse=0,this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(this.x,this.y,this.angle),t.svg.appendChild(this.g)}D.prototype=new j,D.prototype.creeg=function(){let t,e;const i=172,n=57,r="stroke:#999999;stroke-width:2; fill: #c6cbe8; fill-opacity: 0.5",o=document.createElementNS(s,"g");t=document.createElementNS(s,"path"),e="M 0 0 L "+String(167)+" 0 A 5 5 0 0 1 "+String(i)+" 5 L "+String(i)+" "+String(52)+" A 5 5 90 0 1 "+String(167)+" "+String(n)+" L "+String(-251)+" "+"57 A 5 5 180 0 1 -"+"256 "+String(52)+" L "+String(-256)+" 5 A 5 5 -90 0 1 "+String(-251)+" 0Z";const a="M"+String(158)+" 42A 6 6 180 0 0 "+String(146)+" "+String(42)+"A 6 6 180 0 0 "+String(158)+" "+String(42);e+=a,t.setAttribute("d",e),t.setAttribute("style",r),o.appendChild(t),t=document.createElementNS(s,"path"),e="M"+String(i)+" "+String(16)+"L"+String(i)+" "+String(52)+" A 5 5 90 0 1 "+String(167)+" "+String(n)+" L "+String(-251)+" "+"57 A 5 5 180 0 1 -"+"256 "+String(52)+" L "+String(-256)+" "+String(16)+"Z"+a,t.setAttribute("d",e),t.setAttribute("style",r),o.appendChild(t);const c=document.createElementNS(s,"line");c.setAttribute("x1",0),c.setAttribute("y1",8),c.setAttribute("x2",0),c.setAttribute("y2",0),c.setAttribute("style","stroke: black"),o.appendChild(c);const h={};$.prototype.creeg.call(h),this.gequerre=h.g,this.gequerre.setAttribute("transform","scale(0.7)"),o.appendChild(this.gequerre),this.setAbs(this.abscisse),this.g=o},D.prototype.setAbs=function(t){this.abscisse=t,this.gequerre.setAttribute("transform","translate("+t+",0)")},D.prototype.lanceAnimationGlissement=function(t,e){this.absfin=t,this.pix=t>=this.abscisse?e/4:-e/4,this.dist=Math.abs(t-this.abscisse);const i=this;this.timer=setInterval((function(){i.actionPourGlissement()}),25)},D.prototype.actionPourGlissement=function(){const t=this.abscisse+this.pix,e=Math.abs(this.absfin-t);e>this.dist||!this.doc.animationEnCours?(this.setAbs(this.absfin),clearInterval(this.timer),this.doc.actionSuivante()):(this.dist=e,this.setAbs(t))};const X=H;function H(t){j.call(this,t),this.angle=this.angleInit(),this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(this.x,this.y,this.angle),t.svg.appendChild(this.g)}H.prototype=new j,H.prototype.angleInit=function(){return-40},H.prototype.creeg=function(){let t,e,i,n,r;const o=4.5,a=document.createElementNS(s,"g");t=document.createElementNS(s,"defs"),n=document.createElementNS(s,"linearGradient"),n.setAttribute("id","gradpointe"),r=document.createElementNS(s,"stop"),r.setAttribute("offset","0%"),r.setAttribute("style","stop-color: #f00000;"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","50%"),r.setAttribute("style","stop-color: #eeb444;"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","100%"),r.setAttribute("style","stop-color: #f00000"),n.appendChild(r),n.setAttribute("x1","0%"),n.setAttribute("y1","0%"),n.setAttribute("x2","0%"),n.setAttribute("y2","100%"),t.appendChild(n),a.appendChild(t),t=document.createElementNS(s,"defs"),n=document.createElementNS(s,"linearGradient"),n.setAttribute("id","gradcorps"),r=document.createElementNS(s,"stop"),r.setAttribute("offset","0%"),r.setAttribute("style","stop-color: #810216;"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","25%"),r.setAttribute("style","stop-color: #c64f00;"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","50%"),r.setAttribute("style","stop-color: #ab4a36"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","75%"),r.setAttribute("style","stop-color: #c64f00;"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","100%"),r.setAttribute("style","stop-colr: #810216;"),n.appendChild(r),n.setAttribute("x1","0%"),n.setAttribute("y1","0%"),n.setAttribute("x2","0%"),n.setAttribute("y2","100%"),t.appendChild(n),a.appendChild(t),e=document.createElementNS(s,"path");const c=1.5,h=1.125,l="A1.5 1.125 -90 0 0 15 "+String(c)+"A"+"1.5 "+h+" -90 0 1 15 "+String(-c)+"A"+"1.5 "+h+" -90 0 0 15 "+String(-4.5);i="M 0 0 L15 4.5"+l+"Z",e.setAttribute("d",i),e.setAttribute("style","stroke:black; stroke-width:0.5; fill: url(#gradpointe); fill-opacity: 1;"),a.appendChild(e),e=document.createElementNS(s,"path"),i="M 0 0 L 3 0.9 3 "+String(-.9)+"Z",e.setAttribute("d",i),e.setAttribute("style","stroke:black; stroke-width:0.5; fill: black; fill-opacity: 1;"),a.appendChild(e),e=document.createElementNS(s,"path"),i="M 15 4.5"+l+" L 97 "+String(-4.5)+" L 97 "+String(o)+"Z",e.setAttribute("d",i),e.setAttribute("style","stroke:black; stroke-width:0.5; fill: url(#gradcorps); fill-opacity: 1;"),a.appendChild(e);const u=document.createElementNS(s,"circle");u.setAttribute("r",o),u.setAttribute("cx",97),u.setAttribute("cy",0),u.setAttribute("style","stroke:blue; stroke-width:0.5; fill: blue; fill-opacity: 1;"),a.appendChild(u),this.g=a};const Z=J;function J(t,e){0!==arguments.length&&(this.doc=t,"string"==typeof e&&(e=Number(e)),this.tempo="number"==typeof e&&e>0&&Number.isFinite(e)?100*e:null,this.isReady=!1)}J.prototype.setReady=function(){this.isReady=!0},J.prototype.creegElement=function(){},J.prototype.actionVisible=function(){return!0};const Y=U;function U(t,e){Z.call(this,t,e)}U.prototype=new Z,U.prototype.execute=function(t){const e=this.doc.compas,i=this.doc.compasLeve;e.leve&&(i.montre(!1),e.setPosition(i.x,i.y,i.angle)),!t&&e.visible&&e.montre(!0),e.leve=!1,t||this.doc.actionSuivante(t)},U.prototype.actionVisible=function(){return!!this.doc.getInstrumentVisibility(this.doc.compas.compas,this.indice-1)&&"leve"===this.doc.getCompasStatus(this.indice-1)};const W=Q;function Q(t,e,i){this.doc=t,this.id=e,this.couleur=i,this.zoomfactor=1,this.visible=!1,this.objet="trait"}Q.prototype.positionne=function(){},Q.prototype.initialisePosition=function(){},Q.prototype.translate=function(t,e){this.setPosition(t,e,this.angle,this.zoomfactor)},Q.prototype.tourne=function(t){this.setPosition(this.x,this.y,t,this.zoomfactor)},Q.prototype.zoom=function(t){this.zoomfactor=t,this.setPosition(this.x,this.y,this.angle,t)},Q.prototype.montre=function(t){this.visible=t,this.g&&this.g.setAttribute("visibility",t?"visible":"hidden")},Q.prototype.lanceAnimationTranslation=function(t,e,i){this.xfin=t,this.yfin=e,this.pix=Math.abs(i/4);const s=new I(this.x,this.y,t,e);if(this.dist=s.norme(),0===this.dist)return this.translate(this.xfin,this.yfin),void this.doc.actionSuivante();this.vect=s.vecteurColineaire(this.pix);const n=this;this.timer=setInterval((function(){n.actionPourTranslation()}),25)},Q.prototype.actionPourTranslation=function(){const t=this.x+this.vect.x,e=this.y+this.vect.y,i=new I(t,e,this.xfin,this.yfin).norme();i>this.dist||!this.doc.animationEnCours?(this.translate(this.xfin,this.yfin),clearInterval(this.timer),this.doc.actionSuivante()):(this.dist=i,this.translate(t,e))},Q.prototype.lanceAnimationRotation=function(t,e){const i=d(this.angle);let s=d(t);Math.abs(s-i)>180&&(s>i?s-=360:s+=360),this.anglefin=s,this.angle=i,this.pasdeg=2*e/3,this.pasdeg*=t>=this.angle?1:-1,this.distang=Math.abs(t-this.angle);const n=this;this.timer=setInterval((function(){n.actionPourRotation()}),25)},Q.prototype.actionPourRotation=function(){const t=parseFloat(this.angle)+parseFloat(this.pasdeg),e=Math.abs(t-this.anglefin);e>this.distang||!this.doc.animationEnCours?(this.tourne(this.anglefin),clearInterval(this.timer),this.doc.actionSuivante()):(this.distang=e,this.tourne(t))},Q.prototype.lanceAnimationZoom=function(t,e){this.zoomfin=t,this.vitesse=parseInt(e),this.pas=.05*this.vitesse*(this.zoomfin-this.zoomfactor),this.senspos=this.pas>=0;const i=this;this.timer=setInterval((function(){i.actionPourZoom()}),100)},Q.prototype.actionPourZoom=function(){const t=this.zoomfactor+this.pas;this.doc.animationEnCours&&(this.senspos&&t<this.zoomfin||!this.senspos&&t>this.zoomfin)?this.zoom(t):(this.zoom(this.zoomfin),clearInterval(this.timer),this.doc.actionSuivante())},Q.prototype.updateg=function(){const t=this.g;this.creeg(),this.doc.svg.replaceChild(this.g,t),this.doc.setElement(this.id,this),this.g.setAttribute("visibility","visible")},Q.prototype.creationAnimee=function(){return!1},Q.prototype.finAction=function(){};const K=tt;function tt(t,e,i,s){W.call(this,t,e,"black"),this.x=parseFloat(i),this.y=parseFloat(s),this.xinit=this.x,this.yinit=this.y,this.taille=20,this.angle=0,this.texte="",this.objet="texte"}tt.prototype=new W,tt.prototype.positionne=function(){this.setPosition(this.x,this.y,this.angle,this.zoomfactor)},tt.prototype.translate=function(t,e){this.x=t,this.y=e,this.positionne()},tt.prototype.updateg=function(t){const e=this.g;if(!e)return console.error("Il faut appeler creeg avant updateg");this.doc.svg.replaceChild(t,e),this.g=t,t.setAttribute("visibility","visible")},tt.prototype.creeg=function(){this.g=document.createElementNS(s,"g")},tt.prototype.setPosition=function(t,e,i,s){this.x=t,this.y=e,this.angle=i,this.zoomfactor=s;const n=e+F(this);this.g.setAttribute("transform","scale("+s+") translate("+String(t/s)+","+String(n/s)+") rotate("+i+")")};const et=it;function it(t,e,i,s,n){Z.call(this,t,s),this.id=e;const r=this.doc.getElement(e,i.objet);this.objetRemplace=null===r?null:r,this.objet=i,this.vitesse=arguments.length>=5&&null!=n?Math.abs(parseFloat(n)):8,null!==this.objetRemplace?this.doc.addElement(this.objet):this.doc.pushElement(this.objet)}it.prototype=new Z,it.prototype.execute=function(t){this.objet instanceof K&&(this.objet.x=this.objet.xinit,this.objet.y=this.objet.yinit),null!==this.objetRemplace&&this.objetRemplace.montre(!1),this.objet.creationAnimee()&&!t?this.objet.lanceAnimation(this.vitesse):(this.objet.montre(!0),t?this.objet.finAction():this.doc.actionSuivante())},it.prototype.creegElement=function(){const t=this.doc,e=this.objet;e.creeg(),e.positionne(),e.g.setAttribute("visibility","hidden"),t.svg.appendChild(e.g)},it.prototype.actionVisible=function(){return!(this.objet instanceof K)};const st=nt;function nt(t,e,i,s){Z.call(this,t,i),this.ecartement=e,this.ec10=null===s?16:parseFloat(s)}nt.prototype=new Z,nt.prototype.execute=function(t){t?(this.doc.compas.ecart=this.ecartement,this.doc.compas.positionne()):this.doc.compas.lanceAnimationEcartement(this.ecartement,this.ec10)},nt.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.compas,this.indice-1)};const rt={tex:{inlineMath:[["$","$"],["\\(","\\)"]],packages:{"[+]":["color"]}},svg:{mtextInheritFont:!0},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},loader:{load:["[tex]/noerrors","[tex]/color"]}};let ot;function at(){return ot||(ot=new Promise(((t,e)=>{if("object"==typeof MathJax&&/^3\./.test(MathJax.version))return MathJax.config=rt,t();window.MathJax=rt,MathJax.startup={ready:()=>{clearTimeout(n),MathJax.startup.defaultReady(),MathJax.startup.promise.then((()=>{t()}))}};const i=document.createElement("script");i.type="text/javascript",i.crossOrigin="anonymous";const s=window.mathJax3BaseUrl?`${window.mathJax3BaseUrl}es5/tex-svg.js`:"https://www.mathgraph32.org/js/MathJax3/es5/tex-svg.js";i.src=s;document.getElementsByTagName("head")[0].appendChild(i);const n=setTimeout((()=>{e(Error(`Mathjax non chargé après 60s d’attente (${s})`))}),6e4)})),ot)}const ct=ht;function ht(t,e,i,s,n,r,o,a,c,h,l,u,d,p,b,g){Z.call(this,t,g),this.txt=this.doc.getElement(e,"texte"),this.id=e,this.couleur=i,this.taille=null==s?"20":s.replace(/O/g,"0"),this.style=null===r?"texte":r,this.couleurFond=o,this.opaciteFond=null==a?"0.6":parseFloat(a)/100,this.couleurCadre=c,null!==h&&null===c&&(this.couleurCadre=i),this.epaisseurCadre=null!=h?h:null==c?0:1,this.marge=null==l?0:parseFloat(l),this.margeGauche=null==u?0:parseFloat(u),this.margeDroite=null==d?0:parseFloat(d),this.margeHaut=null==p?0:parseFloat(p),this.margeBas=null==b?0:parseFloat(b),this.texte=n,this.estLatex=this.estAffichageLatex(),this.estLatex||(this.texte=y(A(this.texte)),this.texte=this.traduitCaracteresGrecs(this.texte),this.texte=this.texte.replace(/\*/g,"×"),k(n)&&(this.texte="$"+this.traiteMaths(this.texte)+"$",this.estLatex=!0))}ht.prototype=new Z,ht.prototype.execute=function(t){if(null!=this.txt){this.angle=0;const t=this.txt;t.couleur=this.couleur,t.taille=this.taille,t.texte=this.texte,t.couleurFond=this.couleurFond,t.couleurCadre=this.couleurCadre,t.epaisseurCadre=this.epaisseurCadre,t.updateg(this.g),t.positionne()}t||this.doc.actionSuivante(t)},ht.prototype.estAffichageLatex=function(){return"$"===this.texte.charAt(0)&&"$"===this.texte.charAt(this.texte.length-1)},ht.prototype.traduitCaracteresGrecs=function(t){if(!t.includes("£"))return t;const e=t.split("£").map(((t,e)=>e%2?n[t]||`£${t}£`:t)).join("");return(t.length-t.replace(/£/g,"").length)%2?(console.warn(`Il y a un nombre impair de £ dans cette chaîne : ${t}`),e.substr(0,e.length-1)):e},ht.prototype.traiteMaths=function(t){let e;const i=t,s="texte"===this.style,n=i.split(/<\/?br *\/?>/gi);if(n.length<=1)return M(t,s);let r="\\begin{array}{l}";for(e=0;e<n.length;e++)0!==e&&(r+="\\\\"),r+=M(n[e],s);return r+="\\end{array}",r},ht.prototype.prepare=function(){let t;if(this.estLatex&&(t=this.texte.replace(/^\$(.*)\$$/,"$1"),t||(console.error(Error("texte latex mais pas enveloppé de $, ignoré"),this.texte),this.estLatex=!1)),this.estLatex){const e=this;at().then((()=>{const i=e.doc.getWidth(),s=e.taille,n=e.prelatex()+t;e.ex=.45*s;const r={em:s,ex:e.ex,containerWidth:i,display:!1};return e.doc.debug&&console.log("On passe à MathJax la string",n),MathJax.tex2svgPromise(n,r)})).then((t=>{e.html=t,e.creegLatex(),e.setReady()})).catch((t=>{console.error(t),alert("Pb Mathjax, impossible d’afficher le LaTeX correctement")}))}else this.creeg(),this.setReady()},ht.prototype.prelatex=function(){return"\\color{"+this.couleur+"}"},ht.prototype.creegLatex=function(){try{const t=this.html.firstChild,e=t.cloneNode(!0),i=document.createElementNS(s,"g");i.appendChild(e);const n=parseFloat(t.getAttribute("width"))*this.ex,r=parseFloat(t.getAttribute("height"))*this.ex,o=e.style["vertical-align"],a=(o&&parseFloat(o)||1)*this.ex;e.setAttribute("width",n+"px"),e.setAttribute("height",r+"px"),e.style["vertical-align"]=`${a}px`,e.setAttribute("x","0");const c=F(this);if(e.setAttribute("y",String(-c)),i.setAttribute("visibility","hidden"),null!==this.couleurFond||null!==this.couleurCadre){i.setAttribute("visibility","hidden"),this.doc.svg.appendChild(i),this.rectAff={};const t=parseFloat(this.epaisseurCadre),{x:e,y:s,width:n,height:r}=i.getBBox();this.rectAff.height=r+2*t+4+2*this.marge+this.margeHaut+this.margeBas,this.rectAff.width=n+2*t+2+2*this.marge+this.margeGauche+this.margeDroite,this.rectAff.x=e-t-1-this.marge-this.margeGauche,this.rectAff.y=s-t-1-this.marge-this.margeHaut,i.setAttribute("visibility","visible"),this.doc.svg.removeChild(i),this.creeRectangle(i,null==this.couleurFond?"white":this.couleurFond)}this.g=i}catch(t){console.error("Erreur dans ActionEcrireTexte.creegLatex (on remplace par un <g> vide) :",t),this.g=document.createElementNS(s,"g")}},ht.prototype.creeg=function(){let t,e,i,n,r,o,a,c,l,u,d,p,f,m,y,A,x,v,S=0;const w="<",E="£e(",C="£i(",k=document.createElementNS(s,"g"),M=F(this),P=M+2;let I=0;const O=.4*M;if(""!==this.texte){if(o=document.createElementNS(s,"text"),o.setAttribute("pointer-events","none"),o.setAttribute("x",0),o.setAttribute("y",0),r="text-anchor:left;font-size:"+M+"px;fill:"+this.couleur+";",o.setAttribute("style",r),n=this.texte.replace(/ /g," "),-1===this.texte.indexOf(w)&&-1===this.texte.indexOf(E)&&-1===this.texte.indexOf(C)&&-1===this.texte.indexOf("<br>"))o.appendChild(document.createTextNode(n));else for(y=n.split(/<br>/gi),m=-P,A=0;A<y.length;A++)for(x=!0,i=y[A];""!==i;){if(t=i.indexOf(w),c=i.indexOf(E),l=i.indexOf(C),x&&(m+=P+I),-1!==c&&(m+=O),-1===t&&-1===c&&-1===l){e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.setAttribute("dy",S),x&&(e.setAttribute("x",0),e.setAttribute("y",m),x=!1),S=0,e.appendChild(document.createTextNode(i)),o.appendChild(e);break}for(;-1!==i.indexOf(w)||-1!==i.indexOf(E)||-1!==i.indexOf(C);)if(t=i.indexOf(w),c=i.indexOf(E),l=i.indexOf(C),u=-1===t?-1===c?l:-1===l?c:Math.min(l,c):-1===c?-1===l?t:Math.min(t,l):-1===l?Math.min(t,c):Math.min(t,l,c),u>0)e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.setAttribute("dy",S),x&&(e.setAttribute("x",0),e.setAttribute("y",m),x=!1),S=0,e.appendChild(document.createTextNode(i.substring(0,u))),o.appendChild(e),i=i.substring(u);else if(0===t){const t=new h(!1,!1,!1,this.couleur,"",M);a=b(i),N(-1===a?i:i.substring(0,a),t,o,x,m),x=!1,i=-1!==a?i.substring(a):"",S=0}else d=u===c,v=g(i),e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.setAttribute("dy",S+"px"),x&&(e.setAttribute("x",0),e.setAttribute("y",m),x=!1),v.erreur?e.appendChild(document.createTextNode(i)):(e.appendChild(document.createTextNode(v.operande)),o.appendChild(e),e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.appendChild(document.createTextNode(v.exposant)),S=O,d?S=-S:I=S,e.setAttribute("dy",S+"px"),p=.6*M,f="font-size:"+p+"px;",e.setAttribute("style",f),o.appendChild(e),S=-S),i=v.texte}k.appendChild(o)}if(k.setAttribute("visibility","hidden"),null!=this.couleurFond||null!=this.couleurCadre){k.setAttribute("visibility","hidden"),this.doc.svg.appendChild(k),this.rectAff={};const t=parseFloat(this.epaisseurCadre);this.rectAff.height=k.getBBox().height+2*t+3+2*this.marge+this.margeHaut+this.margeBas,this.rectAff.width=k.getBBox().width+2*t+2+2*this.marge+this.margeGauche+this.margeDroite,this.rectAff.x=k.getBBox().x-t-1-this.marge-this.margeGauche,this.rectAff.y=k.getBBox().y-t-1-this.marge-this.margeHaut,k.setAttribute("visibility","visible"),this.doc.svg.removeChild(k),this.creeRectangle(k,null==this.couleurFond?"white":this.couleurFond)}this.g=k},ht.prototype.contientBalisesItaliqueOuUnderlineOuFontOuBold=function(t){return/<(u|b|i|font[^>]+)>/gi.test(t)},ht.prototype.creeRectangle=function(t,e){const i=document.createElementNS(s,"rect"),n="stroke-width:"+this.epaisseurCadre+"px;stroke:"+this.couleurCadre+";fill:"+e+";fill-opacity:"+this.opaciteFond+";";i.setAttribute("style",n),i.setAttribute("x",this.rectAff.x),i.setAttribute("y",this.rectAff.y),i.setAttribute("width",this.rectAff.width),i.setAttribute("height",this.rectAff.height),i.setAttribute("pointer-events","none"),t.insertBefore(i,t.childNodes[0])};const lt=ut;function ut(t,e,i,s){Z.call(this,t,i),this.abscisseFin=parseFloat(e),this.pix10=null===s?8:String(Math.abs(s))}ut.prototype=new Z,ut.prototype.execute=function(t){t?(this.doc.requerre.setAbs(this.abscisseFin),this.doc.requerre.positionne()):this.doc.requerre.lanceAnimationGlissement(this.abscisseFin,this.pix10)},ut.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.requerre,this.indice-1)};const dt=pt;function pt(t,e,i,s,n){j.call(this,t);const r=null==t.compasLeve?null:t.compasLeve.g;this.x=e,this.y=i,this.angle=s,this.ecart=n,this.creeg(),this.g.setAttribute("visibility","hidden"),this.setPosition(e,i,s),null==r?t.svg.appendChild(this.g):t.svg.replaceChild(this.g,r)}pt.prototype=new j,pt.prototype.creeg=function(){let t,e,i;const n=this.ecart,r=document.createElementNS(s,"g");this.ecart>16&&(t=document.createElementNS(s,"rect"),t.setAttribute("x",8),t.setAttribute("y",-3.5),t.setAttribute("width",this.ecart-16),t.setAttribute("height",7),t.setAttribute("rx",1),t.setAttribute("ry",1),t.setAttribute("style","stroke:black;stroke-width:0.5;fill:silver;fill-opacity:1"),r.appendChild(t)),i=document.createElementNS(s,"path"),i.setAttribute("d","M0 0 L8 1 8 -1Z"),i.setAttribute("style","stroke:black;stroke-width:0.5;fill:black;fill-opacity:1"),r.appendChild(i);const o=n-16;e=document.createElementNS(s,"line"),e.setAttribute("x1",8),e.setAttribute("y1",0),e.setAttribute("x2",8+o/8),e.setAttribute("y2",0),e.setAttribute("style","stroke: black; stroke-width:0.5;"),r.appendChild(e),i=document.createElementNS(s,"path");const a=String(n-8);i.setAttribute("d","M"+n+" 0 L"+a+" 1.5 "+a+" -1.5Z"),i.setAttribute("style","stroke:black;stroke-width:0.5;fill:black;fill-opacity:1"),r.appendChild(i),e=document.createElementNS(s,"line"),e.setAttribute("x1",a),e.setAttribute("y1",0),e.setAttribute("x2",String(n-8-o/8)),e.setAttribute("y2",0),e.setAttribute("style","stroke: black; stroke-width:0.5;"),r.appendChild(e),e=document.createElementNS(s,"line");let c=String(n-8-o/8-2);e.setAttribute("x1",c),e.setAttribute("y1",-3.5),e.setAttribute("x2",c),e.setAttribute("y2",3.5),e.setAttribute("style","stroke: black; stroke-width:0.5;"),r.appendChild(e),e=document.createElementNS(s,"line"),c=String(n-8-o/3-2),e.setAttribute("x1",c),e.setAttribute("y1",-3.5),e.setAttribute("x2",c),e.setAttribute("y2",3.5),e.setAttribute("style","stroke: black; stroke-width:0.5;"),r.appendChild(e),t=document.createElementNS(s,"rect"),t.setAttribute("x",String(8+o/8-5)),t.setAttribute("y",String(-7)),t.setAttribute("width",8),t.setAttribute("height",3),t.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),r.appendChild(t),t=document.createElementNS(s,"rect"),t.setAttribute("x",String(n-8-o/8-4)),t.setAttribute("y",String(-7)),t.setAttribute("width",8),t.setAttribute("height",3),t.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),r.appendChild(t);const h=12;i=document.createElementNS(s,"path");const l="M"+String(n/2+h)+" "+String(-4)+" A "+String(h)+" 2 180 0 0 "+String(n/2-h)+" "+String(-4)+"A"+String(4)+" 2 90 0 1 "+String(n/2-h)+" "+String(4)+"A"+String(h)+" 2 0 0 0 "+String(n/2+h)+" "+String(4)+"A"+String(4)+" 2 -90 0 1 "+String(n/2+h)+" "+String(-4);i.setAttribute("d",l),i.setAttribute("style","stroke:black;stroke-width:0.75; fill: #666666; fill-opacity: 1"),r.appendChild(i),e=document.createElementNS(s,"line"),e.setAttribute("x1",String(n/2+h)),e.setAttribute("y1",-3.5),e.setAttribute("x2",String(n/2-h)),e.setAttribute("y2",3.5),e.setAttribute("style","stroke: black; stroke-width:0.5;"),r.appendChild(e),e=document.createElementNS(s,"line"),e.setAttribute("x1",String(n/2-h)),e.setAttribute("y1",-3.5),e.setAttribute("x2",String(n/2+h)),e.setAttribute("y2",3.5),e.setAttribute("style","stroke: black; stroke-width:0.5;"),r.appendChild(e);const u=document.createElementNS(s,"circle");u.setAttribute("cx",String(n/2)),u.setAttribute("cy",0),u.setAttribute("r",5),u.setAttribute("style","stroke:black;stroke-width:0.75; fill: #666666; fill-opacity: 1"),r.appendChild(u),t=document.createElementNS(s,"rect"),t.setAttribute("x",String(8+o/8-5)),t.setAttribute("y",String(-7)),t.setAttribute("width",7),t.setAttribute("height",3),t.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),r.appendChild(t),t=document.createElementNS(s,"rect"),t.setAttribute("x",String(n-8-o/8-4)),t.setAttribute("y",String(-7)),t.setAttribute("width",7),t.setAttribute("height",3),t.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1"),r.appendChild(t),this.g=r},pt.prototype.setPosition=function(t,e,i){this.x=t,this.y=e,this.angle=i,this.g.setAttribute("transform","translate("+t+","+e+") rotate("+i+")")};const bt=gt;function gt(t,e){Z.call(this,t,e)}gt.prototype=new Z,gt.prototype.execute=function(t){const e=this.doc.compas;e.visible&&(e.montre(!1),e.visible=!0),this.doc.compasLeve=new dt(this.doc,e.x,e.y,e.angle,e.ecart),!t&&e.visible&&this.doc.compasLeve.montre(!0),e.leve=!0,t||this.doc.actionSuivante(t)},gt.prototype.actionVisible=function(){return!!this.doc.getInstrumentVisibility(this.doc.compas,this.indice-1)&&"couche"===this.doc.getCompasStatus(this.indice-1)};const ft=mt;function mt(t,e,i,s){Z.call(this,t,s),this.objet=this.doc.getElement(e,i)}mt.prototype=new Z,mt.prototype.execute=function(t){const e=this.objet;null!=e&&e.montre(!1),t||this.doc.actionSuivante(t)},mt.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};const yt=At;function At(t,e,i){Z.call(this,t,i),this.instrument=e}At.prototype=new Z,At.prototype.execute=function(t){const e=this.doc.compas;this.instrument.montre(!1),e.leve&&this.doc.compasLeve.montre(!1),t||this.doc.actionSuivante(t)},At.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const xt=vt;function vt(t,e,i,s){Z.call(this,t,s),this.instrument=e,this.longueur=i}vt.prototype=new Z,vt.prototype.execute=function(t){if(this.instrument===this.doc.regle){const t=this.instrument.visible;this.instrument.longueur=this.longueur;const e=this.instrument.g;this.instrument.creeg(),this.instrument.g.setAttribute("visibility",t?"visible":"hidden"),this.doc.svg.replaceChild(this.instrument.g,e),this.instrument.translate(this.instrument.x,this.instrument.y)}t||this.doc.actionSuivante(t)},vt.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const St=wt;function wt(t,e,i,s){Z.call(this,t,s),this.objet=this.doc.getElement(e,i)}wt.prototype=new Z,wt.prototype.execute=function(t){const e=this.objet;null!==e&&e.montre(!0),t||this.doc.actionSuivante(t)},wt.prototype.actionVisible=function(){return!this.doc.getObjectVisibility(this.objet,this.indice-1)};const Et=Ct;function Ct(t,e,i,s){Z.call(this,t,s),this.instrument=e,this.bmontrer=i}Ct.prototype=new Z,Ct.prototype.execute=function(t){this.instrument.montreGraduations(this.bmontrer),t||this.doc.actionSuivante(t)},Ct.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const Nt=kt;function kt(t,e,i,s,n){Z.call(this,t,n),this.x=null===i?null:parseFloat(i),this.y=null===s?null:parseFloat(s),this.instrument=e}kt.prototype=new Z,kt.prototype.execute=function(t){const e=this.doc.compas;null!==this.x&&null!==this.y&&this.instrument.translate(this.x,this.y),this.instrument!==e||t?this.instrument.montre(!0):(e.leve?this.doc.compasLeve.montre(!0):e.montre(!0),e.visible=!0),t||this.doc.actionSuivante(t)},kt.prototype.actionVisible=function(){return!this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const Mt=Pt;function Pt(t,e,i){Z.call(this,t,i),this.bmontrer=e}Pt.prototype=new Z,Pt.prototype.execute=function(t){this.doc.rapporteur.montreGraduationsExternes(this.bmontrer),t||this.doc.actionSuivante(t)},Pt.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.rapporteur,this.indice-1)};const Ft=It;function It(t,e,i){Z.call(this,t,i),this.nomPoint=e}It.prototype=new Z,It.prototype.prepare=function(){if(this.nomPoint.estLatex){const t=this,e=this.doc.getWidth(),i=F(this.nomPoint)-2,s=this.nomPoint.nom.substring(1);this.ex=i/2;const n={em:i,ex:this.ex,containerWidth:e,display:!1};this.doc.debug&&console.log("chargement MathJax dans ActionNommerPoint"),at().then((()=>MathJax.tex2svgPromise(s,n))).then((e=>{t.nomPoint.html=e,t.nomPoint.creegLatex(),t.setReady()})).catch((t=>{console.error(t),alert("Pb Mathjax, impossible d’afficher le point en LaTeX")}))}else this.nomPoint.creeg(),this.setReady()},It.prototype.execute=function(t){if("point"===this.nomPoint.objet){this.nomPoint.positionne();const t=this.nomPoint.point;null!==t.nom?this.doc.svg.replaceChild(this.nomPoint.g,t.nom.g):this.doc.svg.appendChild(this.nomPoint.g),t.nom=this.nomPoint}this.nomPoint.g.setAttribute("visibility","visible"),t||this.doc.actionSuivante(t)},It.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.nomPoint.point,this.indice-1)};const Ot=jt;function jt(t,e){Z.call(this,t,e)}jt.prototype=new Z,jt.prototype.execute=function(t){t||(this.doc.activeIconeContinuer(),this.doc.animationEnCours=!1)},jt.prototype.actionVisible=function(){return!1};const Lt=Rt;function Rt(t,e,i,s,n){Z.call(this,t,s),this.instrument=e,this.anglefin=parseFloat(i),this.deg10=null==n?8:Math.abs(parseFloat(n))}Rt.prototype=new Z,Rt.prototype.execute=function(t){t?(this.instrument.angle=this.anglefin,this.instrument.positionne(),t||this.doc.actionSuivante(t)):this.instrument.lanceAnimationRotation(this.anglefin,this.deg10)},Rt.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const _t=$t;function $t(t,e){Z.call(this,t,e)}$t.prototype=new Z,$t.prototype.execute=function(t){this.doc.compas.retourne(),t||this.doc.actionSuivante(t)},$t.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.compas,this.indice-1)};const zt=Bt;function Bt(t,e,i,s,n,r){Z.call(this,t,n),this.anglefin=parseFloat(i),this.deg10=null==r?8:Math.abs(parseFloat(r)),this.objet=this.doc.getElement(e,s)}Bt.prototype=new Z,Bt.prototype.execute=function(t){const e=this.objet;null!=e?t?(e.angle=this.anglefin,e.positionne()):e.lanceAnimationRotation(this.anglefin,this.deg10,this.tempo):t||this.doc.actionSuivante(t)},Bt.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};const Vt=Tt;function Tt(t,e,i,s,n,r){Z.call(this,t,n),this.instrument=e,this.xfin=parseFloat(i),this.yfin=parseFloat(s),this.pix10=null==r?8:parseFloat(r)}Tt.prototype=new Z,Tt.prototype.execute=function(t){isNaN(this.xfin)||isNaN(this.yfin)?this.doc.actionSuivante(t):t?this.instrument.translate(this.xfin,this.yfin):this.instrument.lanceAnimationTranslation(this.xfin,this.yfin,this.pix10)},Tt.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const qt=Gt;function Gt(t,e,i,s,n,r,o){Z.call(this,t,r),this.xfin=parseFloat(i),this.yfin=parseFloat(s),this.pix10=null==o?8:parseFloat(o),this.type=n,this.objet=this.doc.getElement(e,n)}Gt.prototype=new Z,Gt.prototype.execute=function(t){const e=this.objet;null!=e?t?e.translate(this.xfin,this.yfin):e.lanceAnimationTranslation(this.xfin,this.yfin,this.pix10):this.doc.actionSuivante(t)},Gt.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};const Dt=Xt;function Xt(t,e,i,s,n){Z.call(this,t,s),this.instrument=e,this.zoomfin=parseFloat(i)/100,this.vitesse=parseInt(n)}Xt.prototype=new Z,Xt.prototype.execute=function(t){t?(this.instrument.zoomfactor=this.zoomfin,this.instrument.positionne()):this.instrument.lanceAnimationZoom(this.zoomfin,this.vitesse)},Xt.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};const Ht=Zt;function Zt(t,e,i,s,n,r){Z.call(this,t,n),this.objet=this.doc.getElement(e,s),this.zoomfin=parseFloat(i)/100,this.vitesse=r,this.type=s}Zt.prototype=new Z,Zt.prototype.execute=function(t){const e=this.objet;null!=e?t?(e.zoomfactor=this.zoomfin,e.positionne()):e.lanceAnimationZoom(this.zoomfin,this.vitesse):this.doc.actionSuivante(t)},Zt.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};const Jt=Yt;function Yt(t,e,i,s,n,r){Z.call(this,t,n),this.rayFin=parseFloat(i),this.pix10=null==r?8:parseFloat(r),this.type=s,this.objet=this.doc.getElement(e,s)}Yt.prototype=new Z,Yt.prototype.execute=function(t){const e=this.objet;null!=e?t?e.donneRayon(this.rayFin):e.lanceAnimationModificationRayon(this.rayFin,this.pix10):this.doc.actionSuivante(t)},Yt.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};const Ut=Wt;function Wt(t,e,i,s,n,r){W.call(this,t,e,i),this.epaisseur=s,this.opacite=arguments.length>=5?n:"100",this.styleTrait=arguments.length>=6?r:"continu";const o=parseFloat(this.opacite/100);this.style="stroke:"+i+";stroke-width:"+s+";stroke-opacity:"+o+";stroke-linecap:round;","tiret"===this.styleTrait&&(this.style+="stroke-dasharray:10 8 10;")}Wt.prototype=new W;const Qt=Kt;function Kt(t,e,i,s,n,r,o,a,c,h,l){this.x=parseFloat(i),this.y=parseFloat(s),this.ray=parseFloat(n),this.ang1=parseFloat(r),this.ang2=parseFloat(o),this.motif=null==l?"simple":l,Ut.call(this,t,e,a,c,1),this.opaciteRemplissage=null==h?.7:parseFloat(h)/100,this.objet="angle"}Kt.prototype=new Ut,Kt.prototype.creeg=function(){let t,e,i,n,o,a,c,h,l,u;const p=this.motif,b=this.ray,g=this.ang1,f=this.ang2,m=f-g,y=d(m);var A;A=Math.abs(m)-180,t=Math.abs(A)<1e-7?this.ang1<=this.ang2:y>0;const x=new I(this.x,this.y,this.x+Math.cos(g*r),this.y+Math.sin(g*r)).vecteurColineaire(b),v=new I(this.x,this.y,this.x+Math.cos(f*r),this.y+Math.sin(f*r)).vecteurColineaire(b);let S=this.x+x.x,w=this.y+x.y,E=this.x+v.x,C=this.y+v.y;const N=document.createElementNS(s,"g");let k=document.createElementNS(s,"path");const M=-1!==p.indexOf("plein")?this.couleur:"none";e="none"!==M?"M"+this.x+" "+this.y+"L"+S+" "+w+"A"+b+" "+b+" "+this.ang1+" 0 "+(t?"1 ":"0 ")+E+" "+C+" Z":"M"+S+" "+w+"A"+b+" "+b+" "+this.ang1+" 0 "+(t?"1 ":"0 ")+E+" "+C,k.setAttribute("d",e);const P="stroke:"+this.couleur+";stroke-width:"+this.epaisseur+";",F=P+"fill:"+M+";fill-opacity:"+this.opaciteRemplissage+";";k.setAttribute("style",F),N.appendChild(k);const O=-1!==p.indexOf("O"),j=x.tourne(y/2),L=this.x+j.x,R=this.y+j.y;if(O){const t=document.createElementNS(s,"circle");t.setAttribute("r",5),t.setAttribute("cx",L),t.setAttribute("cy",R),t.setAttribute("style",P+"fill:none;"),N.appendChild(t)}const _=-1!==p.indexOf("triple")?2:-1!==p.indexOf("double")?1:0;for(let r=1;r<=_;r++){k=document.createElementNS(s,"path");const i=b-5*r,n=x.vecteurColineaire(i),o=v.vecteurColineaire(i);S=this.x+n.x,w=this.y+n.y,E=this.x+o.x,C=this.y+o.y,e="M"+S+" "+w+"A"+i+" "+i+" "+this.ang1+" 0 "+(t?"1 ":"0 ")+E+" "+C,k.setAttribute("d",e),k.setAttribute("style",P+"fill:none;"),N.appendChild(k)}const $=-1!==p.indexOf("///")?3:-1!==p.indexOf("//")?2:-1!==p.indexOf("/")?1:0;if(0===$)return void(this.g=N);const z=_+1,B=j.vecteurColineaire(1);switch($){case 1:c=this.x+B.x*b,h=this.y+B.y*b,i=document.createElementNS(s,"line"),i.setAttribute("x1",c-5*B.x*z),i.setAttribute("y1",h-5*B.y*z),i.setAttribute("x2",c+5*B.x),i.setAttribute("y2",h+5*B.y),i.setAttribute("style",F),N.appendChild(i);break;case 2:l=y/6,u=6,Math.abs(l)>=Math.abs(u)&&(l=u),n=B.tourne(l),o=this.x+n.x*b,a=this.y+n.y*b,i=document.createElementNS(s,"line"),i.setAttribute("x1",o-5*B.x*z),i.setAttribute("y1",a-5*B.y*z),i.setAttribute("x2",o+5*B.x),i.setAttribute("y2",a+5*B.y),i.setAttribute("style",F),N.appendChild(i),n=B.tourne(-l),o=this.x+n.x*b,a=this.y+n.y*b,i=document.createElementNS(s,"line"),i.setAttribute("x1",o-5*B.x*z),i.setAttribute("y1",a-5*B.y*z),i.setAttribute("x2",o+5*B.x),i.setAttribute("y2",a+5*B.y),i.setAttribute("style",F),N.appendChild(i);break;case 3:c=this.x+B.x*b,h=this.y+B.y*b,i=document.createElementNS(s,"line"),i.setAttribute("x1",c-5*B.x*z),i.setAttribute("y1",h-5*B.y*z),i.setAttribute("x2",c+5*B.x),i.setAttribute("y2",h+5*B.y),i.setAttribute("style",F),N.appendChild(i),l=y/4,u=9,Math.abs(l)>=Math.abs(u)&&(l=u),n=B.tourne(l),o=this.x+n.x*b,a=this.y+n.y*b,i=document.createElementNS(s,"line"),i.setAttribute("x1",o-5*B.x*z),i.setAttribute("y1",a-5*B.y*z),i.setAttribute("x2",o+5*B.x),i.setAttribute("y2",a+5*B.y),i.setAttribute("style",F),N.appendChild(i),n=B.tourne(-l),o=this.x+n.x*b,a=this.y+n.y*b,i=document.createElementNS(s,"line"),i.setAttribute("x1",o-5*B.x*z),i.setAttribute("y1",a-5*B.y*z),i.setAttribute("x2",o+5*B.x),i.setAttribute("y2",a+5*B.y),i.setAttribute("style",F),N.appendChild(i)}this.g=N};const te=ee;function ee(t,e,i,s,n,r,o,a){this.xsommet=parseFloat(i),this.ysommet=parseFloat(s),this.xinter=parseFloat(n),this.yinter=parseFloat(r),Ut.call(this,t,e,o,a,100),this.objet="angle_droit"}ee.prototype=new Ut,ee.prototype.creeg=function(){let t=new I(this.xsommet,this.ysommet,this.xinter,this.yinter);const e=t.norme();t=t.vecteurColineaire(e/Math.sqrt(2)),t=t.tourne(45);const i=t.tourne(-90),n=document.createElementNS(s,"polyline"),r=String(this.xsommet+t.x)+" "+String(this.ysommet+t.y)+" "+this.xsommet+" "+this.ysommet+" "+String(this.xsommet+i.x)+" "+String(this.ysommet+i.y);n.setAttribute("points",r),n.setAttribute("style",this.style+"fill:none;"),this.g=n};const ie=se;function se(t,e,i,s,n,r,o,a,c,h,l){this.x=parseFloat(i),this.y=parseFloat(s),this.ray=parseFloat(n),this.debut=parseFloat(r),this.fin=parseFloat(o),Ut.call(this,t,e,a,c,h,l)}se.prototype=new Ut,se.prototype.creeg=function(){const t=this.debut,e=this.fin,i=this.ray,n=t<e?"1":"0",o=Math.abs(e-t),a=document.createElementNS(s,"g");if(o>=359.9){const t=document.createElementNS(s,"circle");t.setAttribute("r",i),t.setAttribute("cx",0),t.setAttribute("cy",0),t.setAttribute("style",this.style+";fill:none;"),a.appendChild(t)}else{const c=document.createElementNS(s,"path"),h=new I(Math.cos(t*r)*i,Math.sin(t*r)*i),l=new I(Math.cos(e*r)*i,Math.sin(e*r)*i),u="M"+h.x+" "+h.y+"A"+i+" "+i+" "+t+" "+(o>180?"1":"0")+" "+n+" "+l.x+" "+l.y;c.setAttribute("d",u),c.setAttribute("style",this.style+";fill:none"),a.appendChild(c)}a.setAttribute("transform","translate("+this.x+","+this.y+")"),a.setAttribute("visibility","hidden"),this.g=a},se.prototype.creationAnimee=function(){return!0},se.prototype.lanceAnimation=function(t){const e=this.doc.compas;null==this.doc.compasLeve&&(this.doc.compasLeve=new dt(this.doc,e.x,e.y,e.angle,e.ecart));const i=this.doc.compasLeve;this.ray=this.doc.compas.ecart,this.angfin=this.fin,this.pasdeg=t/2,this.pasdeg*=this.fin>=this.debut?1:-1,this.distang=Math.abs(this.fin-this.debut),this.fin=this.debut,e.setPosition(this.x,this.y,this.debut),i.setPosition(this.x,this.y,this.debut);const s=this;this.timer=setInterval((function(){s.actionPourAnimation()}),25)},se.prototype.actionPourAnimation=function(){const t=this.doc.compas,e=this.doc.compasLeve;this.fin+=this.pasdeg;const i=Math.abs(this.angfin-this.fin);i>this.distang||!this.doc.animationEnCours?(this.fin=this.angfin,this.updateg(),this.finAction(),clearInterval(this.timer),this.doc.actionSuivante()):(this.distang=i,this.updateg(),t.setPosition(this.x,this.y,this.fin),null!==e&&e.setPosition(this.x,this.y,this.fin))},se.prototype.finAction=function(){this.doc.compas.setPosition(this.x,this.y,this.fin),null!==this.doc.compasLeve&&this.doc.compasLeve.setPosition(this.x,this.y,this.fin)};const ne=re;function re(t,e,i,s,n,r,o,a,c,h){Ut.call(this,t,e,o,a,h,"continu"),this.x=parseFloat(i),this.y=parseFloat(s),this.ray=null===n?10:parseFloat(n),this.ecartAngle=parseFloat(r),this.couleur=o,this.couleurFond=null===c?o:c,this.angle=0,this.objet="gabarit"}re.prototype=new Ut,re.prototype.creationAnimee=function(){return!1},re.prototype.creeg=function(){const t=this.ecartAngle,e=this.ray,i=t>=0?"1":"0",n=Math.abs(t),o=document.createElementNS(s,"g"),a=document.createElementNS(s,"path"),c=new I(Math.cos(t*r)*e,Math.sin(t*r)*e),h="M 0 0 L "+e+" 0 A "+e+" "+e+" 0 "+(n>180?"1":"0")+" "+i+" "+c.x+" "+c.y+" Z";a.setAttribute("d",h);const l=parseFloat(this.opacite/100),u="stroke:"+this.couleur+";stroke-width:"+this.epaisseur+";fill:"+this.couleurFond+";fill-opacity:"+l+";";a.setAttribute("style",u),o.appendChild(a),o.setAttribute("transform","translate("+this.x+","+this.y+") rotate("+this.angle+")"),o.setAttribute("visibility","hidden"),this.g=o},re.prototype.donneRayon=function(t){this.ray=t,this.updateg(),this.setPosition(this.x,this.y,this.angle)},re.prototype.setPosition=function(t,e,i){this.x=t,this.y=e,this.angle=i,this.g.setAttribute("transform","translate("+t+","+e+") rotate("+i+")")},re.prototype.lanceAnimationModificationRayon=function(t,e){this.rayFin=t,this.rayInit=this.ray;const i=t-this.ray;if(this.dist=Math.abs(i),this.dray=Math.sign(i)*Math.abs(e/4),0===this.dist)return;const s=this;this.timer=setInterval((function(){s.actionPourModificationRayon()}),25)},re.prototype.actionPourModificationRayon=function(){const t=this.ray+this.dray,e=Math.abs(t-this.rayInit);e>this.dist||!this.doc.animationEnCours?(this.donneRayon(this.rayFin),clearInterval(this.timer),this.doc.actionSuivante()):(this.dist=e,this.donneRayon(t))};const oe=ae;function ae(t,e,i,s,n,r,o,a,c,h){W.call(this,t,"axeIEP",h),this.pente=null==e?"horizontal":e,this.largeur=i,this.haut=null==s?0:parseFloat(s),this.gauche=null==n?0:parseFloat(n),this.distanceBord=parseFloat(r),this.xgrad=o,this.xmin=a,this.xmax=c,this.cadre={},this.cadre.gauche=30*this.gauche,this.cadre.haut=30*this.haut,this.width=30*i,this.cadre.droite=this.gauche+this.width,this.cadre.bas=this.haut+this.width}ae.prototype=new W,ae.prototype.creeg=function(){let t,e,i,n;this.g=document.createElementNS(s,"g");const r="stroke:black;stroke-width:1;";"horizontal"===this.pente&&this.xmax-this.xmin>this.xgrad?(e=Math.floor((this.xmax-this.xmin)/this.xgrad),i=30*this.distanceBord,n=C(this.xmin,this.xmax,this.xgrad),this.tracer_abscisses(n,this.xgrad,e,i),t=document.createElementNS(s,"line"),t.setAttribute("style",r),t.setAttribute("x1",this.cadre.gauche),t.setAttribute("y1",i),t.setAttribute("x2",this.cadre.droite),t.setAttribute("y2",i),this.g.appendChild(t)):this.xmax-this.xmin>this.xgrad&&(e=Math.floor((this.xmax-this.xmin)/this.xgrad),i=30*Number(this.distanceBord),n=C(this.xmin,this.xmax,this.xgrad),this.tracer_ordonnees(n,this.xgrad,e,i),t=document.createElementNS(s,"line"),t.setAttribute("style",r),t.setAttribute("x1",i),t.setAttribute("y1",this.cadre.bas),t.setAttribute("x2",i),t.setAttribute("y2",this.cadre.haut),this.g.appendChild(t))},ae.prototype.tracer_abscisses=function(t,e,i,n){let r,o,a,c;const h="stroke:black;stroke-width:1.5;";for(r=document.createElementNS(s,"line"),r.setAttribute("style",h),r.setAttribute("x1",this.cadre.gauche),r.setAttribute("y1",n),r.setAttribute("x2",this.cadre.droite),r.setAttribute("y2",n),this.g.appendChild(r),c=0;c<=i;c++){r=document.createElementNS(s,"line"),r.setAttribute("style",h),a=this.mettre_x_en_pixels(t+c*e),r.setAttribute("x1",a),r.setAttribute("y1",String(n-5)),r.setAttribute("x2",a),r.setAttribute("y2",String(n+5)),this.g.appendChild(r),o=document.createElementNS(s,"text"),o.setAttribute("x",a),o.setAttribute("y",n+12+5);const i="text-anchor:left;font-size:12px;fill:"+this.couleur+";";o.setAttribute("style",i),o.appendChild(document.createTextNode(String(t+c*e))),this.g.appendChild(o)}},ae.prototype.tracer_ordonnees=function(t,e,i,n){let r,o,a;const c="stroke:black;stroke-width:1.5;";for(r=document.createElementNS(s,"line"),r.setAttribute("style",c),r.setAttribute("x1",n),r.setAttribute("y1",this.cadre.haut),r.setAttribute("x2",n),r.setAttribute("y2",this.cadre.bas),this.g.appendChild(r),a=0;a<=i;a++){r=document.createElementNS(s,"line"),r.setAttribute("style",c);const i=this.mettre_y_en_pixels(t+a*e);r.setAttribute("x1",String(n-5)),r.setAttribute("y1",i),r.setAttribute("x2",String(n+5)),r.setAttribute("y2",i),this.g.appendChild(r),o=document.createElementNS(s,"text"),o.setAttribute("x",n+10),o.setAttribute("y",i+2);const h="text-anchor:left;font-size:12px;fill:"+this.couleur+";";o.setAttribute("style",h),o.appendChild(document.createTextNode(String(t+a*e))),this.g.appendChild(o)}},ae.prototype.mettre_x_en_pixels=function(t){return m(t,this.xmin,this.xmax,this.cadre.gauche,this.cadre.droite)},ae.prototype.mettre_y_en_pixels=function(t){return m(t,this.xmax,this.xmin,this.cadre.haut,this.cadre.bas)};const ce=he;function he(t,e,i,s,n,r,o,a,c,h){this.x1=parseFloat(i),this.y1=parseFloat(s),this.x2=parseFloat(n),this.y2=parseFloat(r),Ut.call(this,t,e,o,a,c,h)}he.prototype=new Ut,he.prototype.creeg=function(){const t=document.createElementNS(s,"g"),e=document.createElementNS(s,"line");e.setAttribute("x1",this.x1),e.setAttribute("y1",this.y1),e.setAttribute("x2",this.x2),e.setAttribute("y2",this.y2),e.setAttribute("style",this.style),t.appendChild(e),t.setAttribute("visibility","hidden"),this.g=t},he.prototype.creationAnimee=function(){return!0},he.prototype.lanceAnimation=function(t){this.vitesse=t/4;const e=new I(this.x1,this.y1,this.x2,this.y2);if(this.dist=e.norme(),u(this.dist))return void this.doc.actionSuivante();this.vect=e.vecteurColineaire(1.8*this.vitesse),this.xfin=this.x2,this.yfin=this.y2,this.x2=this.x1,this.y2=this.y1;const i=this.doc.crayon;i.setPosition(this.x1,this.y1,i.angle);const s=this;this.timer=setInterval((function(){s.actionPourAnimation(s)}),25)},he.prototype.actionPourAnimation=function(){this.x2+=this.vect.x,this.y2+=this.vect.y;const t=new I(this.x1,this.y1,this.x2,this.y2).norme(),e=this.doc.crayon;t>this.dist||!this.doc.animationEnCours?(this.x2=this.xfin,this.y2=this.yfin,this.finAction(),this.updateg(),clearInterval(this.timer),this.doc.actionSuivante()):(e.translate(this.x2,this.y2),this.updateg())},he.prototype.finAction=function(){this.doc.crayon.translate(this.x2,this.y2)};const le=ue;function ue(t,e,i,s,n,r,o,a,c,h){ce.call(this,t,e,i,s,n,r,o,a,c,h)}ue.prototype=new ce,ue.prototype.creeg=function(){if(this.calcule(),this.horsFenetre)this.g=document.createElementNS(s,"g");else{const t=document.createElementNS(s,"line");t.setAttribute("x1",this.xext1),t.setAttribute("y1",this.yext1),t.setAttribute("x2",this.xext2),t.setAttribute("y2",this.yext2),t.setAttribute("style",this.style),this.g=t}this.g.setAttribute("visibility","hidden")},ue.prototype.calcule=function(){const{x1:t,y1:e,x2:i,y2:s}=this;if(t===i&&e===s)return void(this.horsFenetre=!0);this.horsFenetre=!1;const n=this.doc.getWidth(),r=this.doc.getHeight();if(t===i)return this.xext1=t,this.yext1=0,this.xext2=t,this.yext2=r,t<0||t>n?void(this.horsFenetre=!0):(this.xext1=t,this.yext1=0,this.xext2=t,void(this.yext2=r));if(e===s)return this.xext1=0,this.yext1=e,this.xext2=n,this.yext2=e,e<0||e>r?void(this.horsFenetre=!0):(this.xext1=0,this.yext1=e,this.xext2=n,void(this.yext2=e));let o=0;const a=(s-e)/(i-t),c=this.y1+a*(0-t);c>=0&&c<=r&&(o++,this.xext1=0,this.yext1=c);const h=n,l=a*(h-t)+e;if(l>=0&&l<=r){if(o++,1!==o)return this.xext2=h,void(this.yext2=l);this.xext1=h,this.yext1=l}const u=(0-e)/a+t;if(u>0&&u<n){if(o++,1!==o)return this.xext2=u,void(this.yext2=0);this.xext1=u,this.yext1=0}const d=r,p=(d-e)/a+t;p>0&&p<=n?(o++,2===o?(this.xext2=p,this.yext2=d):this.horsFenetre=!0):this.horsFenetre=!0,this.horsFenetre&&(this.xext1=0,this.yext1=c,this.xext2=h,this.yext2=l)};const de=pe;function pe(t,e,i,s,n,r,o,a,c,h){le.call(this,t,e,i,s,n,r,o,a,c,h)}pe.prototype=new le,pe.prototype.calcule=function(){le.prototype.calcule.call(this);const t=new I(this.x1,this.y1,this.x2,this.y2);if(this.horsFenetre)return;const e=new I(this.x1,this.y1,this.xext1,this.yext1);if(e.presqueNul()){const e=new I(this.x1,this.y1,this.xext2,this.yext2);w(e,t)?(this.xext1=this.x1,this.yext1=this.y1):(this.xext2=this.xext1,this.yext2=this.yext1,this.xext1=this.x1,this.yext1=this.y1)}else w(e,t)?(this.xext2=this.xext1,this.yext2=this.yext1,this.xext1=this.x1,this.yext1=this.y1):(this.xext1=this.x1,this.yext1=this.y1)};const be=ge;function ge(t,e,i){this.doc=t,this.id=e,this.url=i,this.x=0,this.y=0,this.angle=0,this.objet="image",this.zoomfactor=1}ge.prototype=new W,ge.prototype.initialisePosition=function(){this.x=0,this.y=0,this.angle=0,this.zoomfactor=1,this.positionne()},ge.prototype.prepareAction=function(){const t=new Image;t.owner=this,this.action=new et(this.doc,this.id,this),this.action.isReady=!1,this.doc.ajouteAction(this.action),t.onload=function(){const t=this.owner;t.width=this.width,t.height=this.height,t.action.isReady=!0},t.src=this.url},ge.prototype.creeg=function(){const t=document.createElementNS(s,"image");t.setAttribute("width",this.width),t.setAttribute("height",this.height),t.setAttributeNS("http://www.w3.org/1999/xlink","href",this.url),t.setAttribute("x",this.x),t.setAttribute("y",this.y),t.setAttribute("visibility","hidden"),this.g=t,this.setPosition(this.x,this.y,this.angle,this.zoomfactor),this.doc.svg.appendChild(t)},ge.prototype.setPosition=function(t,e,i,s){this.x=t,this.y=e,this.angle=i,this.zoomfactor=s,this.g?this.g.setAttribute("transform","scale("+s+") translate("+String(t/s)+","+String(e/s)+") rotate("+i+")"):console.error("Il faut appeler imag.creeg avant imag.setPosition")},ge.prototype.positionne=function(){this.setPosition(this.x,this.y,this.angle,this.zoomfactor)};const fe=me;function me(t,e,i,s,n,r,o,a,c,h){Ut.call(this,t,e,o,a,c,h),this.xdeb=i,this.ydeb=s,this.abs=n.split(","),this.ord=r.split(","),this.objet="trait"}me.prototype=new Ut,me.prototype.creeg=function(){let t,e;const i=document.createElementNS(s,"polyline");for(t=this.xdeb+" "+this.ydeb,e=0;e<this.abs.length;e++)t+=" "+this.abs[e]+" "+this.ord[e];i.setAttribute("points",t),i.setAttribute("style",this.style+"fill:none;"),i.setAttribute("visibility","hidden"),this.g=i},me.prototype.creationAnimee=function(){return!0},me.prototype.lanceAnimation=function(){this.sauveabs=this.abs,this.sauveord=this.ord,this.abs=[],this.ord=[],this.ind=-1;const t=this;this.timer=setInterval((function(){t.actionPourAnimation()}),25)},me.prototype.actionPourAnimation=function(){this.ind++;const t=this.doc.crayon;if(this.ind>=this.sauveabs.length)this.abs=this.sauveabs,this.ord=this.sauveord,this.updateg(),clearInterval(this.timer),this.finAction(),this.doc.actionSuivante();else{const e=this.sauveabs[this.ind],i=this.sauveord[this.ind];this.abs.push(e),this.ord.push(i),this.updateg(),t.setPosition(parseFloat(e),parseFloat(i),t.angle),this.updateg()}},me.prototype.finAction=function(){const t=this.abs.length;this.doc.crayon.translate(parseFloat(this.abs[t-1]),parseFloat(this.ord[t-1]))};const ye=Ae;function Ae(t,e,i,s,n,r,o){this.x=parseFloat(i),this.y=parseFloat(s),this.motif=o,Ut.call(this,t,e,n,r,100),this.objet="longueur"}Ae.prototype=new Ut,Ae.prototype.creeg=function(){let t,e,i;const n=2.5;switch(this.motif){case"/":t=document.createElementNS(s,"line"),t.setAttribute("x1",5),t.setAttribute("y1",-5),t.setAttribute("x2",-5),t.setAttribute("y2",5),t.setAttribute("style",this.style);break;case"\\":t=document.createElementNS(s,"line"),t.setAttribute("x1",-5),t.setAttribute("y1",-5),t.setAttribute("x2",5),t.setAttribute("y2",5),t.setAttribute("style",this.style);break;case"//":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i+=2)e=document.createElementNS(s,"line"),e.setAttribute("x1",i*n+5),e.setAttribute("y1",-5),e.setAttribute("x2",i*n-5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e);break;case"///":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i++)e=document.createElementNS(s,"line"),e.setAttribute("x1",5*i+5),e.setAttribute("y1",-5),e.setAttribute("x2",5*i-5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e);break;case"\\\\":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i+=2)e=document.createElementNS(s,"line"),e.setAttribute("x1",i*n-5),e.setAttribute("y1",-5),e.setAttribute("x2",i*n+5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e);break;case"\\\\\\":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i++)e=document.createElementNS(s,"line"),e.setAttribute("x1",5*i-5),e.setAttribute("y1",-5),e.setAttribute("x2",5*i+5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e);break;case"X":t=document.createElementNS(s,"g"),e=document.createElementNS(s,"line"),e.setAttribute("x1",-5),e.setAttribute("y1",-5),e.setAttribute("x2",5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e),e=document.createElementNS(s,"line"),e.setAttribute("x1",5),e.setAttribute("y1",-5),e.setAttribute("x2",-5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e);break;case"O":t=document.createElementNS(s,"circle"),t.setAttribute("cx",0),t.setAttribute("cy",0),t.setAttribute("r",5),t.setAttribute("style",this.style+"fill:none;");break;default:t=document.createElementNS(s,"g")}this.g=t},Ae.prototype.positionne=function(){this.g.setAttribute("transform","translate("+this.x+","+this.y+")")},Ae.prototype.translate=function(t,e){this.x=t,this.y=e,this.positionne()};const xe=ve;function ve(t,e,i,s,n,r,o,a,c,h,l){ce.call(this,t,e,i,s,n,r,o,a,c,h),this.stylefleche=l}ve.prototype=new ce,ve.prototype.creeg=function(){if(ce.prototype.creeg.call(this),"vecteur"===this.stylefleche){const t=12,e=this.x1,i=this.x2,n=this.y1,r=this.y2,o=new I(i,r,e,n).vecteurColineaire(t),h=new I(o.x*a-o.y*c,o.x*c+o.y*a),l=new I(o.x*a+o.y*c,-o.x*c+o.y*a),u=String(i+h.x)+" "+String(r+h.y)+","+i+" "+r+","+String(i+l.x)+" "+String(r+l.y),d=document.createElementNS(s,"polyline");d.setAttribute("points",u);const p="stroke:"+this.couleur+";stroke-width:"+this.epaisseur+";stroke-opacity:"+this.opacite+";fill:none";d.setAttribute("style",p),this.g.appendChild(d)}};const Se=we;function we(t,e,i,s,n,r,o){this.idSeg=i,this.motif=r,this.rayon=null!==o?o:"5",Ut.call(this,t,e,s,n,100),this.objet="marque"}we.prototype=new Ut,we.prototype.creeg=function(){let t,e,i;if(this.doc.getElement(this.idSeg,"trait")instanceof xe){const n=this.rayon,r=5,o=r/2,a=5;switch(this.motif){case"/":t=document.createElementNS(s,"line"),t.setAttribute("x1",n),t.setAttribute("y1",-n),t.setAttribute("x2",-n),t.setAttribute("y2",n),t.setAttribute("style",this.style);break;case"\\":t=document.createElementNS(s,"line"),t.setAttribute("x1",-n),t.setAttribute("y1",-n),t.setAttribute("x2",n),t.setAttribute("y2",n),t.setAttribute("style",this.style);break;case"//":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i+=2)e=document.createElementNS(s,"line"),e.setAttribute("x1",i*o+n),e.setAttribute("y1",-n),e.setAttribute("x2",i*o-n),e.setAttribute("y2",n),e.setAttribute("style",this.style),t.appendChild(e);break;case"///":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i++)e=document.createElementNS(s,"line"),e.setAttribute("x1",i*r+n),e.setAttribute("y1",-n),e.setAttribute("x2",i*r-n),e.setAttribute("y2",n),e.setAttribute("style",this.style),t.appendChild(e);break;case"\\\\":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i+=2)e=document.createElementNS(s,"line"),e.setAttribute("x1",i*o-n),e.setAttribute("y1",-n),e.setAttribute("x2",i*o+n),e.setAttribute("y2",n),e.setAttribute("style",this.style),t.appendChild(e);break;case"\\\\\\":for(t=document.createElementNS(s,"g"),i=-1;i<=1;i++)e=document.createElementNS(s,"line"),e.setAttribute("x1",i*r-n),e.setAttribute("y1",-n),e.setAttribute("x2",i*r+n),e.setAttribute("y2",n),e.setAttribute("style",this.style),t.appendChild(e);break;case"X":t=document.createElementNS(s,"g"),e=document.createElementNS(s,"line"),e.setAttribute("x1",-n),e.setAttribute("y1",-n),e.setAttribute("x2",n),e.setAttribute("y2",n),e.setAttribute("style",this.style),t.appendChild(e),e=document.createElementNS(s,"line"),e.setAttribute("x1",n),e.setAttribute("y1",-n),e.setAttribute("x2",-n),e.setAttribute("y2",n),e.setAttribute("style",this.style),t.appendChild(e);break;case"O":t=document.createElementNS(s,"circle"),t.setAttribute("cx",0),t.setAttribute("cy",0),t.setAttribute("r",a),t.setAttribute("style",this.style+"fill:none;");break;default:t=document.createElementNS(s,"g")}}else console.log("Maque de segment non associée à un objet segment"),t=document.createElementNS(s,"g");this.g=t},we.prototype.positionne=function(){const t=this.doc.getElement(this.idSeg,"trait"),e=new I(t.x1,t.y1,t.x2,t.y2),i=(t.x1+t.x2)/2,s=(t.y1+t.y2)/2,n=-e.angle();this.g.setAttribute("transform","translate("+i+","+s+") rotate("+n+") ")},we.prototype.translate=function(t,e){this.x=t,this.y=e,this.positionne()};var Ee=i(42987);const Ce=Ne;function Ne(t,e,i,s,n,r){W.call(this,t,e,r),this.dx=null==i?2:parseFloat(i),this.dy=null==s?4:parseFloat(s),this.nom=y(A(n)),this.taille=20,this.point=this.doc.getElement(this.id,"point"),this.objet="point",this.nom=this.nom.replace(/\*/g,"×"),k(n)?(this.nom="$"+this.traiteMaths(this.nom)+"$",this.estLatex=!0):this.estLatex=!1}Ne.prototype=new W,Ne.prototype.creeg=function(){let t,e,i,n,r,o,a,c,l,u,d,p,f,m,y,A,x,v,S=0;const w="<",E="£e(",C="£i(",k=document.createElementNS(s,"g"),M=F(this),P=M+2;let I=0;const O=.4*M;if(0!==this.nom.length){if(o=document.createElementNS(s,"text"),o.setAttribute("pointer-events","none"),o.setAttribute("x",0),o.setAttribute("y",0),r="text-anchor:left;font-size:"+M+"px;fill:"+this.couleur+";",o.setAttribute("style",r),n=this.nom.replace(/ /g," "),-1===this.nom.indexOf(w)&&-1===this.nom.indexOf(E)&&-1===this.nom.indexOf(C)&&-1===this.nom.indexOf("<br>"))o.appendChild(document.createTextNode(n));else for(y=n.split(/<br>/gi),m=-P,A=0;A<y.length;A++)for(x=!0,i=y[A];0!==i.length;){if(t=i.indexOf(w),c=i.indexOf(E),l=i.indexOf(C),x&&(m+=P+I),-1!==c&&(m+=O),-1===t&&-1===c&&-1===l){e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.setAttribute("dy",S),x&&(e.setAttribute("x",0),e.setAttribute("y",m),x=!1),S=0,e.appendChild(document.createTextNode(i)),o.appendChild(e);break}for(;-1!==i.indexOf(w)||-1!==i.indexOf(E)||-1!==i.indexOf(C);)if(t=i.indexOf(w),c=i.indexOf(E),l=i.indexOf(C),u=-1===t?-1===c?l:-1===l?c:Math.min(l,c):-1===c?-1===l?t:Math.min(t,l):-1===l?Math.min(t,c):Math.min(t,l,c),u>0)e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.setAttribute("dy",S),x&&(e.setAttribute("x",0),e.setAttribute("y",m),x=!1),S=0,e.appendChild(document.createTextNode(i.substring(0,u))),o.appendChild(e),i=i.substring(u);else if(0===t){const t=new h(!1,!1,!1,this.couleur,"",M);a=b(i),N(-1===a?i:i.substring(0,a),t,o,x,m),x=!1,i=-1!==a?i.substring(a):"",S=0}else d=u===c,v=g(i),e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.setAttribute("dy",S+"px"),x&&(e.setAttribute("x",0),e.setAttribute("y",m),x=!1),v.erreur?e.appendChild(document.createTextNode(i)):(e.appendChild(document.createTextNode(v.operande)),o.appendChild(e),e=document.createElementNS(s,"tspan"),e.setAttribute("pointer-events","none"),e.appendChild(document.createTextNode(v.exposant)),S=O,d?S=-S:I=S,e.setAttribute("dy",S+"px"),p=.6*M,f="font-size:"+p+"px;",e.setAttribute("style",f),o.appendChild(e),S=-S),i=v.texte}k.appendChild(o),this.g=k}k.setAttribute("visibility","hidden")},Ne.prototype.creegLatex=function(){try{const t=document.createElementNS(s,"g"),e=this.html.firstChild,i=e.cloneNode(!0);t.appendChild(i);const n=parseFloat(e.getAttribute("width"))*this.ex,r=parseFloat(e.getAttribute("height"))*this.ex,o=i.style["vertical-align"],a=(o&&parseFloat(o)||1)*this.ex;i.setAttribute("width",n+"px"),i.setAttribute("height",r+"px"),(0,Ee.setStyles)(i,"vertical-align",a+"px"),i.setAttribute("x","0");const c=F(this);i.setAttribute("y",String(-c)),i.setAttribute("visibility","hidden"),this.g=t}catch(t){console.error(t,"on remplace par un <g> vide"),this.g=document.createElementNS(s,"g")}},Ne.prototype.positionne=function(){null===this.point&&(this.point=this.doc.getElement(this.id,"point"));const t=this.point.x,e=this.point.y,i=F(this);this.g.setAttribute("transform","translate("+String(t+this.dx)+","+String(e+this.dy+i)+")")},Ne.prototype.traiteMaths=function(t){return P(t,!0)};const ke=Me;function Me(t,e,i,s,n,r){this.x=parseFloat(i),this.y=parseFloat(s),this.xinit=this.x,this.yinit=this.y,this.xcons=this.x,this.ycons=this.y,Ut.call(this,t,e,n,r),this.style+="stroke-linecap:round;",this.nom=null,this.objet="point"}Me.prototype=new Ut,Me.prototype.initialisePosition=function(){this.x=this.xinit,this.y=this.yinit,this.positionne()},Me.prototype.creeg=function(){const t=document.createElementNS(s,"g");let e;e=document.createElementNS(s,"line"),e.setAttribute("x1",-5),e.setAttribute("y1",5),e.setAttribute("x2",5),e.setAttribute("y2",-5),e.setAttribute("style",this.style),t.appendChild(e),e=document.createElementNS(s,"line"),e.setAttribute("x1",-5),e.setAttribute("y1",-5),e.setAttribute("x2",5),e.setAttribute("y2",5),e.setAttribute("style",this.style),t.appendChild(e),this.g=t},Me.prototype.positionne=function(){this.g.setAttribute("transform","translate("+this.x+","+this.y+")")},Me.prototype.translate=function(t,e){this.x=t,this.y=e,this.positionne(),null!==this.nom&&this.nom.positionne()},Me.prototype.updateg=function(){this.setPosition(this.x,this.y)},Me.prototype.montre=function(t){W.prototype.montre.call(this,t),null!==this.nom&&this.nom.g&&this.nom.montre(t)};const Pe=Fe;function Fe(t,e,i,s,n,r,o,a){W.call(this,t,e,n),this.abs=i.split(","),this.ord=s.split(","),this.sauveabs=this.abs,this.sauveord=this.ord,this.epaisseur=r,this.opacite=null==a?"60":a;const c=parseFloat(this.opacite/100);this.couleurFond=null==o?this.couleur:o,this.style="stroke:"+n+";stroke-width:"+r+";fill:"+this.couleurFond+";",this.style+="fill-opacity:"+c+";",this.objet="trait"}Fe.prototype=new W,Fe.prototype.creeg=function(){let t,e;const i=document.createElementNS(s,"polygon");for(t="",e=0;e<this.abs.length;e++)t+=" "+this.abs[e]+" "+this.ord[e];i.setAttribute("points",t),i.setAttribute("style",this.style),i.setAttribute("visibility","hidden"),this.g=i},Fe.prototype.creationAnimee=function(){return!0},Fe.prototype.lanceAnimation=function(t){this.pix=parseFloat(t/2),this.abs=[],this.abs[0]=this.sauveabs[0],this.ord=[],this.ord[0]=this.sauveord[0],this.ind=0,this.n=0;const e=this.doc.crayon,i=new I(parseFloat(this.sauveabs[0]),parseFloat(this.sauveord[0]),parseFloat(this.sauveabs[1]),parseFloat(this.sauveord[1]));this.longcote=i.norme(),this.vect=i.vecteurColineaire(this.pix),e.setPosition(parseFloat(this.abs[0]),parseFloat(this.ord[0]),e.angle);const s=this;this.timer=setInterval((function(){s.actionPourAnimation()}),25)},Fe.prototype.actionPourAnimation=function(){const t=this.doc.crayon;let e=this.ind;const i=parseFloat(this.abs[e]),s=parseFloat(this.ord[e]);if(this.n++,this.doc.animationEnCours)if(this.n*this.pix<=this.longcote){const n=i+this.n*this.vect.x,r=s+this.n*this.vect.y;this.abs[e+1]=String(n),this.ord[e+1]=String(r),t.translate(n,r),this.updateg()}else if(this.ind++,e++,e===this.sauveabs.length-1)clearInterval(this.timer),this.finAction(),this.doc.actionSuivante();else{this.abs[e]=this.sauveabs[e],this.ord[e]=this.sauveord[e],t.translate(parseFloat(this.abs[e]),parseFloat(this.ord[e]));const i=new I(parseFloat(this.sauveabs[e]),parseFloat(this.sauveord[e]),parseFloat(this.sauveabs[e+1]),parseFloat(this.sauveord[e+1]));this.longcote=i.norme(),this.vect=i.vecteurColineaire(this.pix),this.n=0}else clearInterval(this.timer),this.finAction(),this.doc.actionSuivante()},Fe.prototype.finAction=function(){this.abs=this.sauveabs,this.ord=this.sauveord;const t=this.abs.length;this.updateg(),this.doc.crayon.translate(parseFloat(this.abs[t-1]),parseFloat(this.ord[t-1]))};const Ie=Oe;function Oe(t,e,i,s,n,r,o){W.call(this,t,"quadrillageIEP",o),this.hauteur=parseFloat(i),this.largeur=parseFloat(s),this.haut=null==n?0:parseFloat(n),this.gauche=null==r?0:parseFloat(r),this.type=e,this.cadre={},this.cadre.gauche=30*this.gauche,this.cadre.haut=30*this.haut,this.cadre.droite=this.cadre.gauche+30*this.largeur,this.cadre.bas=this.cadre.haut+30*this.hauteur,this.objet="quadrillage"}Oe.prototype=new W,Oe.prototype.creeg=function(){const t=this.cadre.gauche,e=this.cadre.droite,i=this.cadre.haut,n=this.cadre.bas,r=this.couleur;this.g=document.createElementNS(s,"g");const o=this.doc.svg.getElementById("quadrillageIEP");switch(null!=o&&this.doc.svg.removeChild(o),this.type){case"seyes":this.tracer_grille(r,24,6,t,i,e,n,!1,1),this.tracer_grille(r,24,24,t,i,e,n,!1,1);break;case"millimetre":this.tracer_grille(r,3,3,t,i,e,n,!1,.6),this.tracer_grille(r,30,30,t,i,e,n,!1,.8),this.tracer_grille(r,150,150,t,i,e,n,!1,1);break;case"10x10":case"10x":this.tracer_grille(r,30,30,t,i,e,n,!1,1);break;case"5x5":case"5x":default:this.tracer_grille(r,15,15,t,i,e,n,!1,1)}},Oe.prototype.tracer_grille=function(t,e,i,n,r,o,a,c,h){let l,u;const d="stroke:"+t+";stroke-width:0.5;stroke-opacity:"+h+";";c&&(this.style+="stroke-dasharray:2 2;");let p=Math.ceil(Math.abs(o-n)/e);for(u=0;u<p;u++)l=document.createElementNS(s,"line"),l.setAttribute("style",d),l.setAttribute("x1",n+u*e),l.setAttribute("y1",r),l.setAttribute("x2",n+u*e),l.setAttribute("y2",a),l.setAttribute("style",d),this.g.appendChild(l);for(p=Math.ceil(Math.abs(a-r)/i),u=0;u<p;u++)l=document.createElementNS(s,"line"),l.setAttribute("style",d),l.setAttribute("x1",n),l.setAttribute("y1",r+u*i),l.setAttribute("x2",o),l.setAttribute("y2",r+u*i),l.setAttribute("style",d),this.g.appendChild(l)};const je=Le;function Le(t,e,i,s,n,r,o,a,c,h,l,u,d,p,b){W.call(this,t,"repereIEP",u),this.hauteur=e,this.largeur=i,this.haut=null==s?0:parseFloat(s),this.gauche=null==n?0:parseFloat(n),this.xgrad=parseFloat(r),this.ygrad=parseFloat(o),this.xmin=parseFloat(a),this.xmax=parseFloat(c),this.ymin=parseFloat(h),this.ymax=parseFloat(l),this.grille=null==d?"visible":d,this.axes=null==p?"visible":p,this.etiquettes=null==b?"visible":b,this.cadre={},this.cadre.gauche=30*this.gauche,this.cadre.haut=30*this.haut,this.cadre.droite=this.cadre.gauche+30*this.largeur,this.cadre.bas=this.cadre.haut+30*this.hauteur}Le.prototype=new W,Le.prototype.mettre_x_en_pixels=function(t){return m(t,this.xmin,this.xmax,this.cadre.gauche,this.cadre.droite)},Le.prototype.mettre_y_en_pixels=function(t){return m(t,this.ymax,this.ymin,this.cadre.haut,this.cadre.bas)},Le.prototype.tracer_abscisses=function(t,e,i,n,r,o){let a,c,h,l;const u="stroke:black;stroke-width:0.5;";for("invisible"===this.grille&&"invisible"!==this.axes&&(a=document.createElementNS(s,"line"),a.setAttribute("style",u),a.setAttribute("x1",this.cadre.gauche),a.setAttribute("y1",n),a.setAttribute("x2",this.cadre.droite),a.setAttribute("y2",n),this.g.appendChild(a)),l=0;l<=i;l++)if(a=document.createElementNS(s,"line"),a.setAttribute("style",u),h=this.mettre_x_en_pixels(t+l*e),"invisible"===this.grille?"invisible"!==this.axes&&(a.setAttribute("x1",h),a.setAttribute("y1",String(n-5)),a.setAttribute("x2",h),a.setAttribute("y2",String(n+5)),this.g.appendChild(a)):(a.setAttribute("x1",h),a.setAttribute("y1",r),a.setAttribute("x2",h),a.setAttribute("y2",o),this.g.appendChild(a)),"invisible"!==this.etiquettes&&"invisible"!==this.axes){c=document.createElementNS(s,"text"),c.setAttribute("x",h+2),c.setAttribute("y",n+12);const i="text-anchor:left;font-size:12px;fill:"+this.couleur+";";c.setAttribute("style",i),c.appendChild(document.createTextNode(String(t+l*e))),this.g.appendChild(c)}},Le.prototype.tracer_ordonnees=function(t,e,i,n,r,o){let a,c,h,l;const u="stroke:black;stroke-width:0.5;";for("invisible"===this.grille&&"invisible"!==this.axes&&(a=document.createElementNS(s,"line"),a.setAttribute("style",u),a.setAttribute("x1",n),a.setAttribute("y1",this.cadre.haut),a.setAttribute("x2",n),a.setAttribute("y2",this.cadre.bas),this.g.appendChild(a)),l=0;l<=i;l++)if(a=document.createElementNS(s,"line"),a.setAttribute("style",u),h=this.mettre_y_en_pixels(t+l*e),"invisible"===this.grille?"invisible"!==this.axes&&(a.setAttribute("x1",String(n-5)),a.setAttribute("y1",h),a.setAttribute("x2",String(n+5)),a.setAttribute("y2",h),this.g.appendChild(a)):(a.setAttribute("x1",r),a.setAttribute("y1",h),a.setAttribute("x2",o),a.setAttribute("y2",h),this.g.appendChild(a)),"invisible"!==this.etiquettes&&"invisible"!==this.axes){c=document.createElementNS(s,"text"),c.setAttribute("x",n+2),c.setAttribute("y",h+12);const i="text-anchor:left;font-size:12px;fill:"+this.couleur+";";c.setAttribute("style",i),c.appendChild(document.createTextNode(String(t+l*e))),this.g.appendChild(c)}},Le.prototype.creeg=function(){const t=this.cadre.droite-this.cadre.gauche,e=this.cadre.bas-this.cadre.haut;this.g=document.createElementNS(s,"g");const i=document.createElementNS(s,"defs"),n=document.createElementNS(s,"clipPath");n.setAttribute("id","clipRepere");const r="stroke:"+this.couleur+";stroke-width:1;fill:none;",o=document.createElementNS(s,"rect");if(o.setAttribute("style",r),o.setAttribute("x",this.cadre.gauche),o.setAttribute("y",this.cadre.haut),o.setAttribute("width",t),o.setAttribute("height",e),n.appendChild(o),i.appendChild(n),this.g.appendChild(i),this.g.setAttribute("style","clip-path:url(#clipRepere)"),this.xmax-this.xmin>this.xgrad){const t=Math.floor((this.xmax-this.xmin)/this.xgrad);let e;e=this.ymax*this.ymin<0?this.mettre_y_en_pixels(0):this.ymax<0?this.cadre.haut:this.cadre.bas;const i=C(this.xmin,this.xmax,this.xgrad);this.tracer_abscisses(i,this.xgrad,t,e,this.cadre.haut,this.cadre.bas)}if(this.ymax-this.ymin>this.ygrad){const t=Math.floor((this.ymax-this.ymin)/this.ygrad);let e;e=this.xmax*this.xmin<0?this.mettre_x_en_pixels(0):this.xmax<0?this.cadre.droite:this.cadre.gauche;const i=C(this.ymin,this.ymax,this.ygrad);this.tracer_ordonnees(i,this.ygrad,t,e,this.cadre.gauche,this.cadre.droite)}const a=document.createElementNS(s,"rect");a.setAttribute("style",r),a.setAttribute("x",this.cadre.gauche),a.setAttribute("y",this.cadre.haut),a.setAttribute("width",t),a.setAttribute("height",e),this.g.appendChild(a),this.g.setAttribute("visibility","hidden")};const Re=si,_e=["compas","equerre","rapporteur","regle","requerre","crayon"],$e=["Reset","PrevStep","Pause","Play","Restart","NextStep","GotoEnd","XML"];function ze(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");const a=document.createElementNS(s,"polygon");return a.setAttribute("points","-5,8 8,0 -5,-8"),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),n}function Be(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");let a=document.createElementNS(s,"rect");return a.setAttribute("x",-6),a.setAttribute("y",-7),a.setAttribute("width",3),a.setAttribute("height",14),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),a=document.createElementNS(s,"rect"),a.setAttribute("x",2),a.setAttribute("y",-7),a.setAttribute("width",3),a.setAttribute("height",14),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),n}function Ve(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");const a=document.createElementNS(s,"rect");a.setAttribute("x",5),a.setAttribute("y",-6),a.setAttribute("width",3),a.setAttribute("height",12),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a);const c=document.createElementNS(s,"polygon");return c.setAttribute("points","-7,6 2,0 -7,-6"),c.setAttribute("style","stroke:white;fill:white;"),c.setAttribute("transform","translate(16,16)"),n.appendChild(c),n}function Te(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");const a=document.createElementNS(s,"rect");a.setAttribute("x",-7),a.setAttribute("y",-6),a.setAttribute("width",3),a.setAttribute("height",12),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a);const c=document.createElementNS(s,"polygon");return c.setAttribute("points","7,6 -2,0 7,-6"),c.setAttribute("style","stroke:white;fill:white;"),c.setAttribute("transform","translate(16,16)"),n.appendChild(c),n}function qe(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");let a=document.createElementNS(s,"polygon");return a.setAttribute("points","-6,7 1,0 -6,-7"),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),a=document.createElementNS(s,"polygon"),a.setAttribute("points","3,7 10,0 3,-7"),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),n}function Ge(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");let a=document.createElementNS(s,"polygon");return a.setAttribute("points","6,7 -1,0 6,-7"),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),a=document.createElementNS(s,"polygon"),a.setAttribute("points","-3,7 -10,0 -3,-7"),a.setAttribute("style","stroke:white;fill:white;"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),n}function De(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");const a=document.createElementNS(s,"path");return a.setAttribute("d","M 0 -8 A 8 8 -90 1 1 -8 0"),a.setAttribute("style","stroke:white;stroke-width:3;fill:none;"),a.setAttribute("marker-end","url(#markerarrow"),a.setAttribute("transform","translate(16,16)"),n.appendChild(a),n}function Xe(t,e,i){const n=document.createElementNS(s,"svg");n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",32),n.setAttribute("height",32);const r=document.createElementNS(s,"circle");n.appendChild(r),r.setAttribute("cx",16),r.setAttribute("cy",16),r.setAttribute("r",15);const o="fonce"===i?"filtrebleu":"filtregris";r.setAttribute("style","stroke:none;fill:url(#radial"+i+"); filter:url(#"+o+");");const a=document.createElementNS(s,"text");return a.setAttribute("pointer-events","none"),a.appendChild(document.createTextNode("XML")),a.setAttribute("x",16),a.setAttribute("y",21),a.setAttribute("style","font-family:Arial;font-size:9pt;fill:white;text-anchor:middle"),n.appendChild(a),n}function He(t){return t.getAttribute("id")}function Ze(t){return t.getAttribute("abscisse")}function Je(t){const e=t.getAttribute("ordonnee");return null===e?t.getAttribute("ordonnée"):e}function Ye(t){const e=t.getAttribute("couleur");return e?S(e):"black"}function Ue(t){const e=t.getAttribute("couleur_cadre");return e?S(e):null}function We(t){const e=t.getAttribute("couleur_fond");return e?S(e):null}function Qe(t){const e=t.getAttribute("epaisseur");return null===e||0===parseInt(e)?"1":e}function Ke(t){const e=t.getAttribute("opacite");return null===e?"100":e}function ti(t){const e=t.getAttribute("opacite");return null===e?"50":e}function ei(t){const e=t.getAttribute("pointille");return null==e?"continu":e}function ii(t){const e=t.getAttribute("style");return null==e?"normal":e}function si(t,e,i){this.svg=t,"boolean"==typeof i?(this.autoStart=i,i={}):("object"!=typeof i&&(i={}),this.autoStart=Boolean(i.autoStart)),this.debug=Boolean(i.debug),this.windowxml=null;let s=e;-1===s.search(/<?xml/gi)&&(s='<?xml version="1.0" encoding="UTF-8"?>'+s),s=s.replace(/<action[_]\d*/gi,"<action"),s=s.replace(/<!--.*-->/g,""),s=s.replace(/(="[^"]*")([^ ])/g,"$1 $2").replace(/--/g,""),s=s.replace(/<</g,"<").replace(/>>/g,">"),s=s.replace(/<action(\w)/gi,"<action $1"),s=s.replace(/<commentaire\s*texte\s*=/gi,"<commentaire texteCommentaire ="),s=function(t){let e="";const i=["objet","mouvement","vitesse","tempo","abscisse","ordonnee","id","couleur","pointille","echelle","angle","cible","texte","ecrire","rotation","translation","epaisseur","opacite","masquer","montrer","crayon","equerre","regle","compas","reglequerre","sens","hauteur","largeur","haut","gauche","Xmin","Ymin","Xmax","yMax","Xgrad","Ygrad","image","police","taille","ordonnee_bas_droite","abscisse_bas_droite","ordonnee_haut_gauche","abscisse_haut_gauche"];return t.split(/<action/gi).forEach(((t,s)=>{i.forEach((e=>{const i=new RegExp(" "+e+'[^\\w ]*= *"[\\w]*"',"i"),s=t.search(i);-1!==s&&-1!==t.substring(s+1).search(i)&&(t=t.replace(i,""))})),e+=0===s?t:"<action"+t})),e}(s),this.codexml=s;const n=/<\s*INSTRUMENPOCHE[^>]*>(.*)<\s*\/INSTRUMENPOCHE/is.exec(s);if(!n)throw Error("script xml invalide");this.chdoc="<INSTRUMENPOCHE>"+n[1]+"</INSTRUMENPOCHE>",this.actions=[],this.elements=[],this.compasRetourne=!1,this.compasLeve=null,this.compas=new R(this),this.equerre=new $(this),this.rapporteur=new B(this),this.regle=new T(this),this.requerre=new G(this),this.crayon=new X(this),this.xmldoc=function(t){let e,i;return window.DOMParser?(e=new DOMParser,i=e.parseFromString(t,"text/xml")):window.ActiveXObject?(i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t)):console.error(Error("Votre navigateur ne peut pas analyser du XML, impossible d’utiliser instrumenpoche")),i}(this.chdoc),this.tabact=this.xmldoc.getElementsByTagName("action"),this.started=!1,this.animationEnCours=!0;const r={x:0,y:0,width:800,height:600},o=this.xmldoc.getElementsByTagName("viewBox");if(o&&o.length){o.length>1&&console.error(Error("Il y a plusieurs tags viewBox dans le script, on prend le premier"),o);const t=o[0];Object.keys(r).forEach((e=>{const i=Number(t.getAttribute(e));Number.isFinite(i)&&(e.length<2||i>0)&&(r[e]=i)}))}if(window.innerHeight>.6*r.height&&r.width/r.height<window.innerWidth/window.innerHeight)try{t.parentNode.style.width=window.innerHeight/r.height*r.width+"px"}catch(c){console.error(c)}try{t.parentNode.style.minWidth=r.width/2+"px",t.parentNode.style.minHeight=r.height/2+"px"}catch(c){console.error(c)}this.initialViewBox=r,t.setAttribute("viewBox",`${r.x} ${r.y} ${r.width} ${r.height}`),t.setAttribute("preserveAspectRatio","xMinYMin meet"),this.indiceActionEnCours=0,this.creeActions();const a=this;t.addEventListener("mousemove",(function(t){a.mousemoveListenerSvg(t,t.clientX,t.clientY)}),!1),t.addEventListener("mouseup",(function(){a.mouseupListener()}),!1),t.addEventListener("mouseleave",(function(){a.mouseleaveListener()}),!1),t.addEventListener("touchmove",(function(t){a.mousemoveListenerSvg(t,t.touches[0].pageX,t.touches[0].pageY)}),!1),t.addEventListener("touchend",(function(){a.mouseupListener()}),!1),t.addEventListener("touchcancel",(function(){a.mouseupListener()}),!1),t.addEventListener("touchleave",(function(){a.mouseleaveListener()}),!1),this.debug&&console.log("iepDoc instancié :",this)}si.prototype.setViewBox=function(t){if("object"!=typeof t||Object.keys(this.initialViewBox).some((e=>!Number.isFinite(t[e]))))throw TypeError("paramètre invalide (il faut passer un objet { x: number, y: number, width: number, height: number })");const{x:e,y:i,width:s,height:n}=t;if(s<10||n<10)return console.error(Error("width et height doivent être supérieur à 10"));const r=this.initialViewBox.width/s;this.svg.setAttribute("viewBox",`${e} ${i} ${s} ${n}`),this.barreIcones.setAttribute("transform",`translate(${e+this.xbarre/r}, ${i+this.ybarre/r}) scale(${1/r})`)},si.prototype.zoom=function(t,e,i){if("number"!=typeof t||t<1e-6||t>1e6)throw Error(`zoomFactor invalide : ${typeof t} ${t}`);if(1===t)return this.setViewBox(this.initialViewBox);let{x:s,y:n,width:r,height:o}=this.getViewBox();Number.isFinite(e)||(e=s+r/2),Number.isFinite(i)||(i=n+o/2),r=Math.round(r/t),o=Math.round(o/t),s=e-r/2,n=i-o/2,this.setViewBox({x:s,y:n,width:r,height:o})},si.prototype.isReadyAll=function(){if(this.debug){const t=this.actions.filter((t=>!t.isReady));t.length?console.log(`${t.length} actions pas encore prêtes (sur ${this.actions.length})`):console.log(`Les ${this.actions.length} actions sont prêtes`)}return this.actions.every((t=>t.isReady))},si.prototype.whenReady=function(t,e=30){const i=()=>this.isReadyAll()?t():Date.now()-s<1e3*e?setTimeout(i,100):void t(Error(`Après ${e}s d’attente l’animation n’est pas prête, échec du chargement…`)),s=Date.now();i()},si.prototype.getReadyPromise=function(t=30){return this.isReadyAll()?Promise.resolve():new Promise(((e,i)=>{this.whenReady((t=>{t?i(t):e(this)}),t)}))},si.prototype.getWidth=function(){return this.getViewBox().width},si.prototype.getHeight=function(){return this.getViewBox().height},si.prototype.getViewBox=function(){try{const t=this.svg.getAttribute("viewBox");if(t){const e=t.split(" ").map(Number).filter((t=>!Number.isNaN(t)));if(4===e.length){const[t,i,s,n]=e;if(s>0&&n>0)return{x:t,y:i,width:s,height:n}}}console.error(Error("viewBox invalide"),t)}catch(t){console.error(t)}return this.svg.setAttribute("viewBox","0 0 800 600"),{x:0,y:0,width:800,height:600}},si.prototype.goFast=function(t=100,e){const i=this,s=()=>{i.nextStep(),i.indiceActionEnCours<i.actions.length?setTimeout((()=>s()),t):e&&e()};this.getReadyPromise().then((()=>i.animationEnCours?(i.pause(),(t=>new Promise((e=>{setTimeout((()=>e()),t)})))(500)):Promise.resolve())).then((()=>{i.reset(),s()})).catch((t=>{console.error(t),alert(t.message)}))},si.prototype.creeElementsGraphiques=function(){this.actions.forEach((t=>t.creegElement()))},si.prototype.initialiseOutils=function(){_e.forEach((t=>{this[t].initialisePosition(),this[t].montre(!1)})),this.compas.leve=!1},si.prototype.recreeOutils=function(){_e.forEach((t=>{this[t].updateg(),this[t].montre(!1)})),this.compasLeve=null},si.prototype.init=function(){this.started=!0,this.creeElementsGraphiques(),this.recreeOutils(),this.creeIcones(),this.autoStart?(this.montreIcones(["Pause"]),this.play()):this.montreIcones(["Play"])},si.prototype.creeIcones=function(){const t=this;this.barreIcones=document.createElementNS(s,"g"),this.creeElementsPourIcones(),this.iconReset=Ge(0,0,"fonce"),this.iconResetGris=Ge(0,0,"clair"),this.iconReset.onclick=this.reset.bind(this),this.barreIcones.appendChild(this.iconReset),this.barreIcones.appendChild(this.iconResetGris),this.iconPrevStep=Te(32,0,"fonce"),this.iconPrevStepGris=Te(32,0,"clair"),this.iconPrevStep.onclick=function(){t.prevStep()},this.barreIcones.appendChild(this.iconPrevStep),this.barreIcones.appendChild(this.iconPrevStepGris),this.iconPause=Be(64,0,"fonce"),this.iconPauseGris=Be(64,0,"clair"),this.iconPause.onclick=this.pause.bind(this),this.barreIcones.appendChild(this.iconPause),this.barreIcones.appendChild(this.iconPauseGris),this.iconPlay=ze(96,0,"fonce"),this.iconPlayGris=ze(96,0,"clair"),this.iconPlay.onclick=this.play.bind(this),this.barreIcones.appendChild(this.iconPlay),this.iconContinue=ze(96,0,"rouge"),this.iconContinue.setAttribute("visibility","hidden"),this.iconContinue.onclick=this.continue.bind(this),this.barreIcones.appendChild(this.iconContinue),this.barreIcones.appendChild(this.iconPlayGris),this.iconRestart=De(128,0,"fonce"),this.iconRestartGris=De(128,0,"clair"),this.iconRestart.onclick=this.restart.bind(this),this.barreIcones.appendChild(this.iconRestart),this.barreIcones.appendChild(this.iconRestartGris),this.iconNextStep=Ve(160,0,"fonce"),this.iconNextStepGris=Ve(160,0,"clair"),this.iconNextStep.onclick=function(){t.nextStep()},this.barreIcones.appendChild(this.iconNextStep),this.barreIcones.appendChild(this.iconNextStepGris),this.iconGotoEnd=qe(192,0,"fonce"),this.iconGotoEndGris=qe(192,0,"clair"),this.iconGotoEnd.onclick=function(){t.gotoEnd()},this.barreIcones.appendChild(this.iconGotoEnd),this.barreIcones.appendChild(this.iconGotoEndGris),this.iconXML=Xe(224,0,"fonce"),this.iconXMLGris=Xe(224,0,"clair"),this.iconXML.onclick=function(){t.showXml()},this.barreIcones.appendChild(this.iconXML),this.barreIcones.appendChild(this.iconXMLGris),this.hauteurBarre=32,this.demiLargeurBarre=128,this.xbarre=50,this.ybarre=4,this.barreIcones.setAttribute("transform",`translate(${this.xbarre}, ${this.ybarre})`),this.svg.appendChild(this.barreIcones),this.isDraggingBarre=!1,this.barreIcones.addEventListener("mousedown",(function(e){t.mousedownListenerBarre(e.clientX,e.clientY)}),!1),this.barreIcones.addEventListener("mousemove",(function(e){t.mousemoveListenerBarre(e.clientX,e.clientY)}),!1),this.barreIcones.addEventListener("touchstart",(function(e){t.mousedownListenerBarre(e.touches[0].pageX,e.touches[0].pageY)}),!1),this.barreIcones.addEventListener("touchmove",this.mousemoveListenerBarre.bind(this),!1),this.deltax=0,this.deltay=0},si.prototype.mousedownListenerBarre=function(t,e){this.animationEnCours||(this.isDraggingBarre=!0,this.xcapturebarre=t,this.ycapturebarre=e)},si.prototype.mousemoveListenerBarre=function(){this.animationEnCours?(this.barreIcones.style.cursor="default",this.isDraggingBarre=!1):this.barreIcones.style.cursor="pointer"},si.prototype.mousemoveListenerSvg=function(t,e,i){if(this.isDraggingBarre){const s=this.getWidth(),n=this.getHeight(),r=e-this.xcapturebarre,o=i-this.ycapturebarre,a=this.deltax+r,c=this.deltay+o,h=this.xbarre+a,l=this.ybarre+c;h<=s-2*this.demiLargeurBarre&&h>=0&&l>=0&&l<=n-this.hauteurBarre&&(this.barreIcones.setAttribute("transform","translate("+h+","+l+")"),this.deltax=a,this.deltay=c,this.xcapturebarre=e,this.ycapturebarre=i),t.preventDefault()}},si.prototype.mouseupListener=function(){this.isDraggingBarre=!1},si.prototype.mouseleaveListener=function(){this.isDraggingBarre=!1},si.prototype.showXml=function(){null==this.windowxml?this.windowxml=this.popup():this.windowxml.focus()},si.prototype.montreIcones=function(t){$e.forEach((e=>{const i=t.includes(e),s="icon"+e;this[s]?(this[s].setAttribute("visibility",i?"visible":"hidden"),this[s+"Gris"].setAttribute("visibility",i?"hidden":"visible")):console.error(`L’icone ${s} n’existe pas`)}))},si.prototype.activeIconeContinuer=function(){this.montreIcones(["XML"]),this.iconPlayGris.setAttribute("visibility","hidden"),this.iconContinue.setAttribute("visibility","visible")},si.prototype.gotoEnd=function(){this.animationEnCours=!1,this.initialise(),this.montreIcones(["Reset","PrevStep","Restart","XML"]),this.executeJusque(this.actions.length-1),this.indiceActionEnCours=this.actions.length},si.prototype.play=function(){this.animationEnCours=!0,this.montreIcones(["Pause"]),this.actions[this.indiceActionEnCours]?this.actions[this.indiceActionEnCours].execute(!1):console.error(Error(`Pas d'action ${this.indiceActionEnCours}`),this.actions)},si.prototype.continue=function(){this.indiceActionEnCours!==this.actions.length?(this.iconContinue.setAttribute("visibility","hidden"),this.montreIcones(["Pause"]),this.animationEnCours=!0,this.indiceActionEnCours++,this.actions[this.indiceActionEnCours]?this.actions[this.indiceActionEnCours].execute(!1):console.error(Error(`Pas d'action ${this.indiceActionEnCours}`),this.actions)):this.gotoEnd()},si.prototype.reset=function(){this.animationEnCours=!1,this.initialise(),this.montreIcones(["Play","NextStep","GotoEnd","XML"]),this.indiceActionEnCours=0,this.zoom(1)},si.prototype.restart=function(){if(this.animationEnCours)return this.animationEnCours=!1,void setTimeout(this.restart.bind(this),100);this.initialise(),this.indiceActionEnCours=0,this.zoom(1),this.play()},si.prototype.pause=function(){this.animationEnCours=!1,setTimeout((()=>this.montreIcones(["Reset","PrevStep","Play","Restart","NextStep","GotoEnd","XML"])),500)},si.prototype.nextStep=function(){const t=this.actions.length;this.animationEnCours=!1,this.indiceActionEnCours<t&&(this.actions[this.indiceActionEnCours].actionVisible()?this.indiceActionEnCours++:this.indiceActionEnCours=this.indiceProchaineActionVisible(this.indiceActionEnCours)+1,this.executeJusque(this.indiceActionEnCours-1));const e=["Reset","PrevStep","Restart","XML"];this.indiceActionEnCours===this.actions.length?this.montreIcones(e):this.montreIcones(e.concat(["NextStep","GotoEnd","Play"]))},si.prototype.prevStep=function(){this.animationEnCours=!1,this.indiceActionEnCours=this.indicePrecedenteActionVisible(this.indiceActionEnCours-1),this.indiceActionEnCours>0&&this.executeJusque(this.indiceActionEnCours-1);const t=["Play","NextStep","GotoEnd","XML"];0===this.indiceActionEnCours?this.montreIcones(t):this.montreIcones(t.concat(["Reset","PrevStep"]))},si.prototype.initialise=function(){let t,e;const i=this.svg;for(t=0;t<i.childNodes.length;t++)if(e=i.childNodes[t],e!==this.barreIcones)try{i.childNodes[t].setAttribute("visibility","hidden")}catch(s){console.error(s)}for(t=0;t<this.actions.length;t++){const e=this.actions[t];e instanceof et&&e.objet.initialisePosition()}this.initialiseOutils()},si.prototype.getInstrumentVisibility=function(t,e){if(-1===e)return!1;let i,s=!1;for(let n=0;n<=e;n++)i=this.actions[n],i instanceof Nt?i.instrument===t&&(s=!0):i instanceof yt&&i.instrument===t&&(s=!1);return s},si.prototype.getObjectVisibility=function(t,e){if(-1===e)return!1;let i,s=!1;for(let n=0;n<=e;n++)i=this.actions[n],i instanceof St?i.objet===t&&(s=!0):i instanceof ft&&i.objet===t&&(s=!1);return s},si.prototype.getCompasStatus=function(t){if(-1===t)return"couche";let e,i=!0;for(let s=0;s<=t;s++)e=this.actions[s],e instanceof Y?i=!0:e instanceof bt&&(i=!1);return i?"couche":"leve"},si.prototype.indiceProchaineActionVisible=function(t){if(t>=this.actions.length)return this.actions.length-1;for(let e=t;e<this.actions.length;e++)if(this.actions[e].actionVisible())return e;return this.actions.length-1},si.prototype.indicePrecedenteActionVisible=function(t){if(t<0)return 0;t===this.actions.length&&t--;for(let e=t;e>=0;e--)if(this.actions[e].actionVisible())return e;return 0},si.prototype.montreInstrumentsEtape=function(t){let e=this.getInstrumentVisibility(this.compas,t);this.compas.leve?this.compasLeve.montre(e):this.compas.montre(e),e=this.getInstrumentVisibility(this.crayon,t),this.crayon.montre(e),e=this.getInstrumentVisibility(this.equerre,t),this.equerre.montre(e),e=this.getInstrumentVisibility(this.rapporteur,t),this.rapporteur.montre(e),e=this.getInstrumentVisibility(this.regle,t),this.regle.montre(e),e=this.getInstrumentVisibility(this.requerre,t),this.requerre.montre(e)},si.prototype.executeJusque=function(t){if(!(t>=this.actions.length)){this.initialise(),this.initialiseOutils(),this.animationEnCours=!1;for(let e=0;e<=t;e++)this.actions[e].execute(!0);this.montreInstrumentsEtape(t)}},si.prototype.addElement=function(t){const e=this.elements.findIndex((e=>e.id===t.id&&e.objet===t.objet));-1!==e?this.elements[e]=t:this.elements.push(t)},si.prototype.pushElement=function(t){if(this.elements.some((e=>e.id===t.id&&e.objet===t.objet)))throw Error(`Il y a déjà un élément ${t.id} désignant le même objet`);this.elements.push(t)},si.prototype.getElement=function(t,e){return this.elements.find((i=>i.objet===e&&("quadrillage"===e||i.id===t)))||null},si.prototype.setElement=function(t,e){const i=this.elements.findIndex((e=>e.id===t));return-1!==i&&(this.elements[i]=e,!0)},si.prototype.ajouteAction=function(t){t.indice=this.actions.length,this.actions.push(t)},si.prototype.creeActions=function(){let t,e,i,s,n,r,o,a,c,h,l,u,d,b,g,f,m,y,A,x,v,S,w;for(t=0;t<this.tabact.length;t++){e=this.tabact[t],h=He(e),i=e.getAttribute("mouvement"),m=e.getAttribute("tempo");try{let t,E;switch(i){case"creer":if(s=e.getAttribute("objet"),null!==this.getElement(h,s)){console.error(`L'id ${h} existe déjà, action creer ignorée`,s);break}if(null!=s){switch(s){case"point":n=new ke(this,h,parseFloat(Ze(e)),parseFloat(Je(e)),Ye(e),Qe(e)),r=new et(this,h,n,m);break;case"angle":n=new Qt(this,h,Ze(e),Je(e),e.getAttribute("rayon"),e.getAttribute("angle1"),e.getAttribute("angle2"),Ye(e),Qe(e),ti(e),e.getAttribute("forme")),r=new et(this,h,n,m);break;case"angle_droit":n=new te(this,h,e.getAttribute("abscisse_sommet"),e.getAttribute("ordonnee_sommet"),e.getAttribute("abscisse_inter"),e.getAttribute("ordonnee_inter"),Ye(e),Qe(e)),r=new et(this,h,n,m);break;case"longueur":n=new ye(this,h,Ze(e),Je(e),Ye(e),Qe(e),e.getAttribute("forme")),r=new et(this,h,n,m);break;case"marque":n=new Se(this,h,e.getAttribute("idSeg"),Ye(e),Qe(e),e.getAttribute("forme"),e.getAttribute("rayon")),r=new et(this,h,n,m);break;case"texte":n=new K(this,h,Ze(e),Je(e),Ye(e),e.getAttribute("taille")),r=new et(this,h,n,m);break;case"repere":n=new je(this,e.getAttribute("hauteur"),e.getAttribute("largeur"),e.getAttribute("haut"),e.getAttribute("gauche"),e.getAttribute("Xgrad"),e.getAttribute("Ygrad"),e.getAttribute("Xmin"),e.getAttribute("Xmax"),e.getAttribute("Ymin"),e.getAttribute("Ymax"),Ye(e),e.getAttribute("grille"),e.getAttribute("axes"),e.getAttribute("etiquettes")),r=new et(this,h,n,m);break;case"quadrillage":if(t=e.getAttribute("abscisse_bas_droite"),null!=t){t=parseFloat(t)/30;const i=parseFloat(e.getAttribute("ordonnee_bas_droite"))/30,s=parseFloat(e.getAttribute("abscisse_haut_gauche"))/30,o=parseFloat(e.getAttribute("ordonnee_haut_gauche"))/30;n=new Ie(this,e.getAttribute("quadrillage"),String(i-o),String(t-s),o,s,Ye(e)),r=new et(this,"quadrillageIEP",n,m)}else n=new Ie(this,e.getAttribute("quadrillage"),e.getAttribute("hauteur"),e.getAttribute("largeur"),e.getAttribute("haut"),e.getAttribute("gauche"),Ye(e));r=new et(this,"quadrillageIEP",n,m);break;case"axe":n=new oe(this,e.getAttribute("pente"),e.getAttribute("largeur"),e.getAttribute("haut"),e.getAttribute("gauche"),e.getAttribute("distanceBord"),e.getAttribute("Xgrad"),e.getAttribute("Xmin"),e.getAttribute("Xmax"),Ye(e)),r=new et(this,h,n,m);break;case"gabarit":E=e.getAttribute("ecart_angle"),null===E&&(E="-30"),n=new ne(this,h,e.getAttribute("abscisse"),e.getAttribute("ordonnee"),e.getAttribute("rayon"),E,Ye(e),Qe(e),We(e),Ke(e)),r=new et(this,h,n,m);break;default:console.error(`objet ${n} inconnu => création ignorée`),r=null}r&&(this.ajouteAction(r),r.setReady())}break;case"montrer":s=e.getAttribute("objet"),p(s)?(b=e.getAttribute("abscisse"),g=e.getAttribute("ordonnee"),r=new Nt(this,this[s],b,g,m),"crayon"!==s&&"compas"!==s||null==b||null==g||this[s].translate(parseFloat(b),parseFloat(g))):r=new St(this,h,s,m),this.ajouteAction(r),r.setReady();break;case"masquer":s=e.getAttribute("objet"),r=p(s)?new yt(this,this[s],m):new ft(this,h,s,m),this.ajouteAction(r),r.setReady();break;case"tracer":switch(s=e.getAttribute("objet"),w=e.getAttribute("cible"),null!=w?(n=this.getElement(w,"point"),b=n.xcons,g=n.ycons):(b=parseFloat(Ze(e)),g=parseFloat(Je(e))),s){case"crayon":switch(o=e.getAttribute("forme"),a=this.crayon.x,c=this.crayon.y,h=He(e),o){case null:isNaN(b)||isNaN(g)?(n=new fe(this,h,this.crayon.x,this.crayon.y,e.getAttribute("abscisses"),e.getAttribute("ordonnees"),Ye(e),Qe(e),Ke(e),ei(e),ii(e)),y=n.abs.length,this.crayon.translate(n.abs[y-1],n.ord[y-1])):(n=new xe(this,h,a,c,b,g,Ye(e),Qe(e),Ke(e),ei(e),ii(e)),this.crayon.translate(b,g));break;case"droite":if(isNaN(b)||isNaN(g))break;n=new le(this,h,a,c,b,g,Ye(e),Qe(e),Ke(e),ei(e),ii(e)),this.crayon.translate(b,g);break;case"demidroite":if(isNaN(b)||isNaN(g))break;n=new de(this,h,a,c,b,g,Ye(e),Qe(e),Ke(e),ei(e),ii(e)),this.crayon.translate(b,g);break;case"polygone":if(f=e.getAttribute("cibles"),null===f)n=new Pe(this,h,e.getAttribute("abscisses"),e.getAttribute("ordonnees"),Ye(e),Qe(e),We(e),e.getAttribute("opacite"));else{let t="",i="";f.split(",").forEach(((e,s)=>{const n=0===s?"":",",r=this.getElement(e,"point");t+=n+r.xcons,i+=n+r.ycons})),n=new Pe(this,h,t,i,Ye(e),Qe(e),We(e),e.getAttribute("opacite"))}y=n.abs.length,this.crayon.translate(n.abs[y-1],n.ord[y-1]);break;case"libre":n=new fe(this,h,this.crayon.x,this.crayon.y,e.getAttribute("abscisses"),e.getAttribute("ordonnees"),Ye(e),Qe(e),Ke(e),ei(e),ii(e)),y=n.abs.length,this.crayon.translate(n.abs[y-1],n.ord[y-1])}d=e.getAttribute("vitesse"),null==d&&(d="4"),r=new et(this,He(e),n,m,d),this.ajouteAction(r),r.setReady();break;case"trait":d=e.getAttribute("vitesse"),null===d&&(d=1e4),n=new xe(this,h,e.getAttribute("abscisse1"),e.getAttribute("ordonnee1"),e.getAttribute("abscisse2"),e.getAttribute("ordonnee2"),Ye(e),Qe(e),Ke(e),ei(e),ii(e)),r=new et(this,He(e),n,m,d),this.ajouteAction(r),r.setReady();break;case"compas":n=new ie(this,h,this.compas.x,this.compas.y,this.compas.ecart,this.getAngle(e,"debut"),this.getAngle(e,"fin"),Ye(e),Qe(e),Ke(e),ei(e)),d=e.getAttribute("sens"),null==d&&(d="8"),r=new et(this,He(e),n,m,d),this.ajouteAction(r),r.setReady();break;case"angle_droit":n=new te(this,h,e.getAttribute("abscisse_sommet"),e.getAttribute("ordonnee_sommet"),e.getAttribute("abscisse_inter"),e.getAttribute("ordonnee_inter"),Ye(e),Qe(e)),r=new et(this,He(e),n,m,d),this.ajouteAction(r),r.setReady()}break;case"rotation":s=e.getAttribute("objet"),u=e.getAttribute("sens"),p(s)?(w=e.getAttribute("cible"),null!=w&&null===e.getAttribute("angle")?(n=this.getElement(w,"point"),b=n.xcons,g=n.ycons,x=new I(this[s].x,this[s].y,b,g),l=x.presqueNul()?0:-x.angle()):l="compas"===s?this.getAngle(e,"angle"):e.getAttribute("angle"),r=new Lt(this,this[s],l,m,u)):null===this.getElement(h,s)?r=null:(l=e.getAttribute("angle"),r=new zt(this,h,l,s,m,u)),null!==r&&(this.ajouteAction(r),r.setReady());break;case"translation":s=e.getAttribute("objet"),w=e.getAttribute("cible"),null!=w?(n=this.getElement(w,"point"),b=n.xcons,g=n.ycons):(b=parseFloat(Ze(e)),g=parseFloat(Je(e))),d=e.getAttribute("vitesse"),p(s)?(this[s].x=b,this[s].y=g,r=new Vt(this,this[s],b,g,m,d)):null===this.getElement(h,s)?r=null:("point"===s&&(S=this.getElement(h,"point"),S.xcons=b,S.ycons=g),r=new qt(this,h,b,g,s,m,d)),null!==r&&(this.ajouteAction(r),"crayon"!==s&&"compas"!==s||this[s].translate(b,g),r.setReady());break;case"zoom":s=e.getAttribute("objet"),d=e.getAttribute("vitesse"),p(s)?(v=e.getAttribute("echelle"),this[s].zoomfactor=parseFloat(v)/100,r=new Dt(this,this[s],v,m,d)):r="texte"===s||"image"===s?new Ht(this,h,e.getAttribute("echelle"),s,m,d):null,null!==r&&(this.ajouteAction(r),r.setReady());break;case"ecarter":w=e.getAttribute("cible"),null!=w?(n=this.getElement(w,"point"),x=new I(this.compas.x,this.compas.y,n.xcons,n.ycons),A=x.norme()):A=parseFloat(e.getAttribute("ecart"))*this.compas.zoomfactor,this.compas.ecart=A,r=new st(this,A,m,e.getAttribute("vitesse")),this.ajouteAction(r),r.setReady();break;case"lever":r=new bt(this,m),this.ajouteAction(r),r.setReady();break;case"coucher":r=new Y(this,m),this.ajouteAction(r),r.setReady();break;case"masquer_nombres":r=new Mt(this,!1,m),this.ajouteAction(r),r.setReady();break;case"montrer_nombres":r=new Mt(this,!0,m),this.ajouteAction(r),r.setReady();break;case"graduations":s=e.getAttribute("objet"),r=new Et(this,this[s],!0,m),this.ajouteAction(r),r.setReady();break;case"vide":s=e.getAttribute("objet"),r=new Et(this,this[s],!1,m),this.ajouteAction(r),r.setReady();break;case"retourner":this.compasRetourne=!this.compasRetourne,r=new _t(this,m),this.ajouteAction(r),r.setReady();break;case"glisser":r=new lt(this,e.getAttribute("abscisse"),m,e.getAttribute("vitesse")),this.ajouteAction(r),r.setReady();break;case"chargement":n=new be(this,h,e.getAttribute("url")),n.prepareAction();break;case"ecrire":r=new ct(this,h,Ye(e),e.getAttribute("taille"),e.getAttribute("texte"),e.getAttribute("style"),We(e),e.getAttribute("opacite_fond"),Ue(e),e.getAttribute("epaisseur_cadre"),e.getAttribute("marge"),e.getAttribute("marge_gauche"),e.getAttribute("marge_droite"),e.getAttribute("marge_haut"),e.getAttribute("marge_bas"),m),this.ajouteAction(r),r.prepare();break;case"nommer":if(null!==this.getElement(h,"point")){const t=e.getAttribute("nom");""!==t&&(n=new Ce(this,h,Ze(e),Je(e),t,Ye(e)),r=new Ft(this,n,m),this.ajouteAction(r),r.prepare())}break;case"pause":r=new Ot(this,m),this.ajouteAction(r),r.setReady();break;case"modifier_longueur":s=e.getAttribute("objet"),r=new xt(this,this[s],e.getAttribute("longueur"),m),this.ajouteAction(r),r.setReady();break;case"modifier_rayon":s=e.getAttribute("objet"),r=new Jt(this,h,e.getAttribute("rayon"),s,m),this.ajouteAction(r),r.setReady()}}catch(E){console.error(E)}}this.getReadyPromise().then(this.init.bind(this)).catch((t=>{console.error(t),window.alert(t.message)}))},si.prototype.execute=function(t){this.indiceActionEnCours=0,this.actions[0].execute(t)},si.prototype.actionSuivante=function(t){if(t=Boolean(t),!this.animationEnCours&&!t)return;const e=this.actions[this.indiceActionEnCours];null===e.tempo||t?this.passageActionSuivante(t):setTimeout(this.passageActionSuivante.bind(this,t),e.tempo)},si.prototype.passageActionSuivante=function(t){this.indiceActionEnCours>=this.actions.length||(this.indiceActionEnCours!==this.actions.length-1?(this.indiceActionEnCours++,this.actions[this.indiceActionEnCours].execute(t)):(this.indiceActionEnCours++,this.montreIcones(["Reset","PrevStep","Restart","XML"]),this.animationEnCours=!1))},si.prototype.getAngle=function(t,e){const i=t.getAttribute(e);return null==i?null:this.compasRetourne?String(parseFloat(i)+180):i},si.prototype.creeElementsPourIcones=function(){let t=document.createElementNS(s,"defs");t.appendChild(this.radialGradiant("#9999FF","#000099","radialfonce")),this.svg.appendChild(t),t=document.createElementNS(s,"defs"),t.appendChild(this.radialGradiant("#CCCCCC","#666666","radialclair")),this.svg.appendChild(t),t=document.createElementNS(s,"defs"),t.appendChild(this.radialGradiant("#FF9999","#FF0000","radialrouge")),this.svg.appendChild(t),t=document.createElementNS(s,"defs"),t.appendChild(this.markerArrow("markerarrow")),this.barreIcones.appendChild(t),t=document.createElementNS(s,"defs"),t.appendChild(this.filtreEclairageIcone("filtrebleu")),this.barreIcones.appendChild(t),t=document.createElementNS(s,"defs"),t.appendChild(this.filtreEclairageIcone("filtregris")),this.barreIcones.appendChild(t)},si.prototype.radialGradiant=function(t,e,i){const n=document.createElementNS(s,"radialGradient");n.setAttribute("id",i);let r=document.createElementNS(s,"stop");return r.setAttribute("offset","0%"),r.setAttribute("style","stop-color:"+e+";"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","80%"),r.setAttribute("style","stop-color:"+t+";"),n.appendChild(r),r=document.createElementNS(s,"stop"),r.setAttribute("offset","100%"),r.setAttribute("style","stop-color:"+e+";"),n.appendChild(r),n},si.prototype.markerArrow=function(t){const e=document.createElementNS(s,"marker");e.setAttribute("id",t),e.setAttribute("markerWidth","4"),e.setAttribute("markerHeight","4"),e.setAttribute("refX","0"),e.setAttribute("refY","2"),e.setAttribute("orient","auto");const i=document.createElementNS(s,"path");return i.setAttribute("d","M 0 0 2 2 0 4 Z"),i.setAttribute("style","fill:white;"),e.appendChild(i),e},si.prototype.filtreEclairageIcone=function(t){const e=document.createElementNS(s,"filter");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.setAttribute("color-interpolation-filters","sRGB");const i=document.createElementNS(s,"feDiffuseLighting");i.setAttribute("lighting-color","white"),i.setAttribute("surfaceScale","1"),i.setAttribute("diffuseConstant","1.2"),i.setAttribute("in","SourceGraphic"),i.setAttribute("result","diffOut");const n=document.createElementNS(s,"fePointLight");n.setAttribute("x","5"),n.setAttribute("y","5"),n.setAttribute("z","15"),i.appendChild(n),e.appendChild(i);const r=document.createElementNS(s,"feComposite");return r.setAttribute("in","SourceGraphic"),r.setAttribute("in2","diffOut"),r.setAttribute("operator","arithmetic"),r.setAttribute("k1","1"),r.setAttribute("k2","0"),r.setAttribute("k3","0"),r.setAttribute("k4","0"),e.appendChild(r),e.setAttribute("id",t),e},si.prototype.popup=function(){const t=window.open("","popup","width=700,height=450,toolbar=no,scrollbars=no,resizable=yes");t.iepDoc=this;const e=t.document;e.title="Code Xml de la figure";const i=e.createElement("div"),s=e.createElement("form");i.appendChild(s),i.setAttribute("align","center"),e.body.appendChild(i);const n=e.createElement("textarea");s.appendChild(n),n.setAttribute("cols",80),n.setAttribute("rows",25),n.setAttribute("readonly",!0),n.style.fontSize="13px",n.scrollIntoView();let r=this.codexml;r=r.replace(/>\s*</g,">\n<"),n.appendChild(document.createTextNode(r)),n.select();const o=this;return t.addEventListener("unload",(()=>{o.windowxml=null})),t};const ni=oi;function ri(t){t.docs.forEach((t=>{t.windowxml&&t.windowxml.close()}))}function oi(t){this.debug=Boolean(t&&t.debug),this.debug&&console.log("Mode debug activé"),this.docs=[],window.addEventListener("unload",ri.bind(null,this))}let ai;function ci(t,e,i){return"object"!=typeof i&&(i={}),Promise.resolve().then((()=>{if("undefined"==typeof window||!window.document)throw Error("iepLoad doit être utilisé dans un navigateur");if("string"==typeof t&&(t=document.getElementById(t)),!(t instanceof HTMLElement))throw Error("Conteneur html manquant");if("string"!=typeof e)throw Error("Script xml manquant");return/^http/.test(e)?function(t){if("https:"===window.location.protocol&&"http:"===t.substr(0,5))return Promise.reject(Error(`Impossible de charger ici un script externe qui n’est pas en https (${t})`));return fetch(t,{Accept:"text/xml"}).catch((e=>{throw console.error(e),Error(`Impossible de récupérer le xml ${t}`)})).then((e=>{const{status:i,statusText:s,ok:n}=e;if(i>399)throw Error(`Impossible de récupérer le xml ${t} (erreur ${i} ${s})`);if(!n)throw Error(`Impossible de récupérer le xml ${t}`);return e.text()})).then((e=>{if(!e||!/<INSTRUMENPOCHE/.test(e))throw Error(`L’url ${t} ne retourne pas de script instrumenpoche en xml`);return e}))}(e):e})).then((e=>{if(!e||!/<INSTRUMENPOCHE/.test(e))throw Error("Ce n’est pas un script instrumenpoche valide");"https:"===window.location.protocol&&(e=e.replace(/http:\/\/([a-z]+.sesamath.net)/g,((t,e)=>`https://${e}`))),(0,Ee.empty)(t),(0,Ee.setStyles)(t,{position:"relative",overflow:"auto"});const s=function(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.classList.add("svgIep"),t.appendChild(e),(0,Ee.setStyles)(e,{margin:0,padding:0,width:"98%",height:"98%"}),e}(t),n={};i.debug&&(n.debug=!0),ai||(ai=new ni(n));const r="boolean"!=typeof i.autostart||i.autostart;return ai.addDoc(s,e,r),i.zoom&&function(t){const e=t.parentNode;e.style.resize="both",e.style.padding="0",e.style.border="1px solid black";const i={position:"absolute",zIndex:99,textAlign:"center",padding:0,width:"2.5em",height:"1.8em",left:"0.1em"};(0,Ee.addElement)(e,"button",{style:{...i,top:"0.1em"}},"+").addEventListener("click",(()=>t.iepDoc.zoom(1.1)),!1);(0,Ee.addElement)(e,"button",{style:{...i,top:"2em"}},"-").addEventListener("click",(()=>t.iepDoc.zoom(.9)),!1)}(s),ai}))}oi.prototype.addDoc=function(t,e,i=!0){if("string"==typeof t&&(t=document.getElementById(t)),!t)return new Error("svg manquant");if("svg"!==t.localName)return new Error("svg incorrect");const s={autoStart:i,debug:this.debug},n=new Re(t,e,s);return this.docs.push(n),t.iepDoc=n,n},oi.prototype.flush=function(){this.closeAllXMLWindows(),this.docs.forEach((({svg:t})=>{t.parentNode?t.parentNode.removeChild(t):console.error("le svg",t,"n’a pas de parentNode")})),this.docs=[]},oi.prototype.getDocs=function(){return this.docs},oi.prototype.getLastDoc=function(){const t=this.docs.length;return t?this.docs[t-1]:null}},42987:(t,e,i)=>{"use strict";var s=i(95751),n=i(98035).hasProp;function r(t,e){t.appendChild(window.document.createTextNode(e))}function o(t,e,i){var o,a=window.document.createElement(t);try{if(e)for(o in e)n(e,o)&&("class"===o?a.className=e.class:"className"===o?a.className=e.className:"style"===o?u(a,e.style):a.setAttribute(o,e[o]))}catch(c){s("plantage dans getElement "+t+" avec les attributs ",e,c)}return i&&r(a,i),a}var a,c,h,l=(a=1e4,h="sesa"+(c=0),function(){for(;window.document.getElementById(h)&&c<a;)c++,h="sesa"+c;if(c===a)throw Error("Max de 10000 id générés atteint");return h});function u(t,e){try{if(t&&t.style)if("string"==typeof e)(e=e.split(";")).forEach((function(e){if((e=/([\w]+):(.+)/.exec(e))&&3===e.length){var i=e[1];t.style[i]=e[2]}}));else if("object"==typeof e)for(var i in e)n(e,i)&&(t.style[i]=e[i])}catch(r){s.error(r)}}t.exports={addCss:function(t){for(var e=window.document.getElementsByTagName("head")[0],i=e.getElementsByTagName("link"),n=!1,r=0;r<i.length;r++)if(i[r].href===t){n=!0;break}if(n)s(t+" était déjà présent, on ne l'ajoute pas");else{var o=window.document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=t,e.appendChild(o)}},addJs:function(t,e){var i=window.document.getElementsByTagName("body")[0],s=window.document.createElement("script");s.type="text/javascript",i.appendChild(s),s.addEventListener("load",(function t(){e(),s.removeEventListener("load",t)})),s.src=t},addElement:function(t,e,i,s){var n=o(e,i,s);return t.appendChild(n),n},addElementAfter:function(t,e,i,n){var r=o(e,i,n),a=t.parentNode;return a?a.insertBefore(r,t.nextSibling):s.error(new Error("Navigateur incompatible (pas de parentNode), impossible d'ajouter l'élément")),r},addElementBefore:function(t,e,i,n){var r=o(e,i,n),a=t.parentNode;return a?a.insertBefore(r,t):s.error(new Error("Navigateur incompatible (pas de parentNode), impossible d'insérer l'élément")),r},addElementFirstChild:function(t,e,i,s){var n=o(e,i,s);return t.insertBefore(n,t.firstChild),n},addElementFirstSibling:function(t,e,i,s){var n=o(e,i,s);return t.parentNode.insertBefore(n,t.parentNode.firstChild),n},addText:r,empty:function(t){if(t&&t.firstChild)for(;t.firstChild;)t.removeChild(t.firstChild)},getElement:o,getSize:function(){var t="CSS1Compat"===window.document.compatMode?window.document.documentElement:window.document.body;return{width:Math.floor(Math.min(t.clientWidth,window.innerWidth)),height:Math.floor(Math.min(t.clientHeight,window.innerHeight))}},getNewId:l,setStyles:u}},98035:t=>{"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(t){for(var e=0;e<this.length;e++)t(this[e],e,this)});var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function i(t,e){return"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,e)}function s(t){return"function"==typeof t}function n(t,e){switch(typeof t){case"number":return Math.floor(t)===t;case"string":return Boolean(e&&t&&Math.floor(t)==t);default:return!1}}function r(t){return void 0===t}function o(t,e,i){for(e&&("string"!=typeof e&&(e=String(e)),1!==e.length&&(console.error(new Error("char invalide "+e)),e=void 0)),e||(e="number"==typeof t?"0":" "),"string"!=typeof t&&(t=String(t)),i||(i=2);t.length<i;)t=e+t;return t}t.exports={countSlash:function(t){if("string"!=typeof t)throw new TypeError("countSlash n’accepte qu’une string en paramètre");return t.replace(/[^/]+/g,"").length},escapeForHtml:function(t,i){return i?t.replace(/[&<>"']/g,(function(t){return e[t]})):t.replace(/</g,"&lt;")},formatDate:function(t,e){function i(t,e){return o(t,"0",e)}if(e){if(!(e instanceof Date))throw new TypeError("date is not a Date")}else e=new Date;if("string"!=typeof t)throw new TypeError("format is not a string");return t.replace(/%(.)/g,(function(t,s){switch(s){case"d":return i(e.getDate());case"F":return String(e.getFullYear())+"-"+i(e.getMonth()+1)+"-"+i(e.getDate());case"H":return i(e.getHours());case"m":return i(e.getMonth()+1);case"M":return i(e.getMinutes());case"o":return i(e.getMilliseconds(),3);case"O":return i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds())+"."+i(e.getMilliseconds(),3);case"s":return i(Math.round(e.getTime()/1e3));case"S":return i(e.getSeconds());case"T":return i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds());case"y":return String(e.getFullYear()).substr(2);case"Y":return e.getFullYear();case"%":return"%";default:return"%"+s}}))},getToken:function(){return Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2)},hasProp:i,isArray:function(t){return Array.isArray(t)},isArrayEmpty:function(t){return Boolean(Array.isArray(t)&&0===t.length)},isArrayNotEmpty:function(t){return Boolean(Array.isArray(t)&&t.length)},isDate:function(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)},isError:function(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return t instanceof Error}},isFunction:s,isInArray:function(t,e){if(!Array.isArray(t))throw new Error("isInArray veut un tableau en 1er argument");return-1!==t.indexOf(e)},isInt:n,isIntPos:function(t,e,i){return n(t,i)&&(e?t>0:t>=0)},isObject:function(t){var e=typeof t;return!!t&&("object"===e||"function"===e)},isObjectPlain:function(t){return!!t&&"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)},isRegExp:function(t){return!!t&&"object"==typeof t&&"[object RegExp]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t},isUndefined:r,isUrlAbsolute:function(t){return"string"==typeof t&&/^https?:\/\/[a-z0-9\-._]+(:[0-9]+)?(\/|$)/.test(t)},pad:o,parse:function(t){var e;if("string"==typeof t)try{e=JSON.parse(t)}catch(i){!r(console)&&console.error&&console.error(i)}return e},splitAndTrim:function(t,e){return"string"==typeof t?(e||(e=/[,;\s]+/),t.split(e).map((function(t){return t.trim()})).filter((function(t){return t}))):[]},stringify:function(t,e){var n;try{n=e?JSON.stringify(t,null,e):JSON.stringify(t)}catch(u){var o,a,c=[];for(o in t)if(i(t,o)&&!r(t[o])&&!s(t[o])){a=t[o],n='"'+o+'":';try{n+=e?JSON.stringify(a,null,e):JSON.stringify(a)}catch(u){n+='"'+u.toString()+'"'}c.push(n)}var h=",";if(n="{",e){var l="\n"+" ".repeat(e);h+=l,n+=l}n+=c.join(h),e&&(n+="\n"),n+="}"}return n},toAscii:function(t){if("string"==typeof t){if(/^[\w]*$/.test(t))return t;return[[/[áàâäãå]/g,"a"],[/[ÁÀÂÄÃÅ]/g,"A"],["ç","c"],["Ç","C"],[/[éèêë]/g,"e"],[/[ÉÈÊË]/g,"E"],[/[íìîï]/g,"i"],[/[ÍÌÎÏ]/g,"I"],["ñ","n"],["Ñ","N"],[/[óòôöõ]/g,"o"],[/[ÓÒÔÖÕ]/g,"O"],[/[úùûü]/g,"u"],[/[ÚÙÛÜ]/g,"U"],[/[ýÿ]/g,"y"],[/[ÝŸ]/g,"Y"],["æ","ae"],["Æ","AE"],["œ","oe"],["Œ","OE"]].reduce((function(t,e){return t.replace(e[0],e[1])}),t)}return console.error(new TypeError("not a string"),t),""},toInt:function(t){switch(typeof t){case"number":return Math.round(t);case"string":return""===t?NaN:Math.round(t);default:return NaN}}}},27025:(t,e,i)=>{"use strict";var s=i(98035),n=s.hasProp;t.exports=function t(e,i){if(null===e)return"null";switch(typeof e){case"undefined":return e;case"number":case"boolean":return String(e);case"string":return'"'+e.replace('"','\\"')+'"';case"symbol":return"[Symbol "+e.toString()+"]";default:i||(i=0);var r=" ".repeat(i);i+=2;var o,a=r+"  ",c=[];if(s.isDate(e))return JSON.stringify(e);if(s.isArray(e))return o="[\n",e.forEach((function(s,n){o+=a+t(s,i)+(n===e.length-1?"\n":",\n")})),e.length?o+=r+"]":o+="]",o;if(s.isRegExp(e)||s.isFunction(e))return"function"==typeof e.toSource?e.toSource():e.toString();if(s.isObject(e)){var h=0;for(var l in e)if(n(e,l)){h++;try{JSON.stringify(e[l]),c.push(l+": "+t(e[l],i))}catch(u){c.push(l+': "'+u.toString().replace('"','\\"')+'"')}}return h?"{\n"+a+c.join(",\n"+a)+"\n"+r+"}":s.isObjectPlain(e)?r+"{}":r+e.toString()}return console.error("dump est tombé sur un truc qui ne ressemble à rien de connu",e),s.stringify(e,2)}}},95751:(t,e,i)=>{"use strict";var s=i(27025),n=i(98035),r=n.formatDate,o=n.hasProp,a={debug:0,info:1,notice:1,warn:2,warning:2,error:3,alert:4,critical:4},c=["[debug]","[info]","[warning]","[error]","[CRITICAL]"],h=[console.info||console.log,console.log,console.warn||console.error||console.log,console.error||console.log,console.error||console.log],l=a.info,u="undefined"!=typeof process&&process.env,d=u&&o(process.env,"NODE_APP_INSTANCE"),p=u&&!d,b="[%O]",g=d,f=d&&process.env.NODE_APP_INSTANCE||"N/A";function m(t,e){try{var i=h[e]||console.log,s="";if(p&&(s=r(b)),g&&(s&&(s+=" "),s+="["+f+"]"),s&&(s+=" "),s+=c[e],t.length<1&&(t=[Error("fonction de log appelée sans contenu")]),i(s,t[0]),t.length>1)for(var n=1;n<t.length;n++)i(t[n])}catch(o){}}function y(){l<a.warning&&m(arguments,a.info)}y.debug=function(){l<a.info&&m(arguments,a.debug)},y.info=function(){l<a.warning&&m(arguments,a.info)},y.warn=function(){l<a.error&&m(arguments,a.warning)},y.ifError=function t(){t&&l<a.critical&&m(arguments,a.error)},y.error=function(){l<a.critical&&m(arguments,a.error)},y.critical=function(){m(arguments,a.critical)},y.disable=function(){l=a.error},y.disableDatePrefix=function(){p=!1},y.disableProcessPrefix=function(){g=!1},y.dump=function(t,e,i){"object"!=typeof i&&(i={});var n=i.level||a.debug;"string"==typeof n&&(n=a[n]||a.debug);var r=s(e),o=i.max||1e3;r.length>o&&(r=r.substr(0,o)+"…"),l<=n&&m([t,r],n)},y.enable=function(){l=a.info},y.enableDatePrefix=function(){p=!0},y.enableProcessPrefix=function(){"undefined"==typeof process?console.error("process not available"):g=!0},y.setDatePrefix=function(t){"string"==typeof t?b=t:y.error(new Error("Le préfixe de log doit être une string"))},y.setLogLevel=function(t){switch(t){case 0:case"0":case"debug":l=a.debug;break;case 1:case"1":case"info":case"notice":l=a.notice;break;case 2:case"2":case"warn":case"warning":l=a.warning;break;case 3:case"3":case"err":case"error":l=a.error;break;case 4:case"4":case"alert":case"crit":case"critical":l=a.critical;break;default:y.error("niveau d’erreur "+t)}},y.levels={debug:0,info:1,notice:1,warn:2,warning:2,error:3,alert:4,critical:4},t.exports=y}}]);
//# sourceMappingURL=6085.429c19108aea48ca9893.js.map